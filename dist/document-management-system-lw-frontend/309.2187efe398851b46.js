"use strict";(self.webpackChunkdocument_management_system_lw_frontend=self.webpackChunkdocument_management_system_lw_frontend||[]).push([[309],{2155:(se,k,r)=>{r.d(k,{C:()=>u});var u=function(m){return m.ALREADY_EXIST="ALREADY_EXIST",m.NOT_FOUND="NOT_FOUND",m.INTERNAL_SERVER_ERROR="INTERNAL_SERVER_ERROR",m.ACCESSDENIED="ACCESSDENIED",m}(u||{})},6309:(se,k,r)=>{r.r(k),r.d(k,{DocumentManagemntRoutes:()=>Vt});var u=r(177),m=r(5596),l=r(9159),B=r(7722),T=r(9213),X=r(9115),S=r(8834),R=r(6695),E=r(450),D=r(4912),z=r(2529),v=r(2168),e=r(3953),h=r(4006);let ne=(()=>{class a{constructor(t){this.data=t,this.dialogRef=(0,e.WQX)(h.CP)}static#e=this.\u0275fac=function(i){return new(i||a)(e.rXU(h.Vh))};static#t=this.\u0275cmp=e.VBU({type:a,selectors:[["app-delete-confirm"]],standalone:!0,features:[e.aNF],decls:13,vars:2,consts:[["mat-dialog-title","",1,"d-flex","align-items-center","m-t-10"],[1,"mat-typography"],["mat-button","","mat-dialog-close",""],["mat-button","","mat-dialog-close","","cdkFocusInitial",""]],template:function(i,s){1&i&&(e.j41(0,"h2",0)(1,"span"),e.EFF(2),e.k0s()(),e.j41(3,"mat-dialog-content",1),e.EFF(4," Would you like to delete "),e.j41(5,"span"),e.EFF(6),e.k0s(),e.EFF(7,"?\n"),e.k0s(),e.j41(8,"mat-dialog-actions")(9,"button",2),e.EFF(10,"No"),e.k0s(),e.j41(11,"button",3),e.EFF(12,"Ok"),e.k0s()()),2&i&&(e.R7$(2),e.SpI(" ",s.data.title," "),e.R7$(4),e.JRh(s.data.item))},dependencies:[S.Hl,S.$z,h.E7,h.tx,h.BI,h.Yi,D.X4],styles:["mat-dialog-container[_ngcontent-%COMP%]   mat-dialog-actions[_ngcontent-%COMP%]{align-self:self-end!important}mat-dialog-container[_ngcontent-%COMP%]   mat-dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#078fde!important;font-weight:580!important}"]})}return a})();var U=r(1626),oe=r(7843);let I=(()=>{class a{constructor(t){this.apiService=t}getOneCase(t){return this.apiService.get(`/cases/find/${t}`)}getAllCases(t){return this.apiService.get(`/cases/?case_id=${t}`)}getAllCasesWithServerSidePagination(t,i,s,n){const d=(new U.Nl).set("page",t.toString()).set("limit",i.toString()).set("sortBy",s).set("order",n);return this.apiService.get("/cases",d)}getAllowedUsersByDocId(t){return this.apiService.get(`/documents/${t}/users`)}getAllUsers(){return this.apiService.get("/users")}createNewCase(t,i){return this.apiService.post("/cases",t,i)}updateCase(t,i,s){return this.apiService.put(`/cases/${i}`,t,s)}removeCase(t){return this.apiService.delete(`/cases/${t}`)}removeDocumentCasecade(t){return this.apiService.delete(`/documents/${t}`)}fileBatchUpload(t,i){const s={headers:new U.Lr({Accept:"application/json"}),reportProgress:!0,observe:"events"};return this.apiService.post(`/documents/batch-upload/${t}`,i,s)}fileBatchDownload(t,i){return this.apiService.post("/documents/batch-download/",{case_id:t,fileKeys:i},{responseType:"blob"})}singleFileDownload(t,i){return this.apiService.post("/documents/single-download",{case_id:t,fileUrl:i},{responseType:"blob"})}updateDocumentAccess(t,i,s){return this.apiService.put("/documents/assign-access",{documentId:i,userIds:t},s)}static#e=this.\u0275fac=function(i){return new(i||a)(e.KVO(oe.Z))};static#t=this.\u0275prov=e.jDH({token:a,factory:a.\u0275fac})}return a})();var re=r(2042),K=r(9172),Z=r(5558),Q=r(6354),j=r(9437),W=r(7224),g=r(5505),le=r(8149),G=r(7418),L=r(9088),N=r(4535),F=r(2102),O=r(9631);const ce=()=>[5,10,25,100];function de(a,o){if(1&a){const t=e.RV6();e.j41(0,"mat-form-field",11)(1,"input",12),e.bIt("keyup",function(s){e.eBV(t);const n=e.XpG();return e.Njj(n.applyFilter(s))}),e.k0s()()}}function me(a,o){1&a&&e.nrm(0,"app-content-loader",13),2&a&&e.Y8G("loaderType","button")}function ue(a,o){1&a&&(e.j41(0,"button",14),e.nrm(1,"i-tabler",15),e.k0s()),2&a&&e.Y8G("routerLink","/document-managemnt/single-case")}function pe(a,o){1&a&&(e.j41(0,"th",26),e.EFF(1," Case ID "),e.k0s())}function ge(a,o){if(1&a&&(e.j41(0,"td",27)(1,"div",28)(2,"div",29)(3,"h6",30),e.EFF(4),e.k0s()()()()),2&a){const t=o.$implicit;e.R7$(4),e.SpI(" ",t.case_id," ")}}function fe(a,o){1&a&&(e.j41(0,"th",26),e.EFF(1," Documents "),e.k0s())}function he(a,o){if(1&a&&(e.j41(0,"td",31),e.nrm(1,"i-tabler",32),e.EFF(2),e.k0s()),2&a){const t=o.$implicit;e.R7$(2),e.SpI(" ",t.documents.length," ")}}function _e(a,o){1&a&&(e.j41(0,"th",26),e.EFF(1," Last Updated Date "),e.k0s())}function Ce(a,o){if(1&a&&(e.j41(0,"td",33),e.EFF(1),e.nI1(2,"date"),e.k0s()),2&a){const t=o.$implicit;e.R7$(),e.SpI(" ",e.i5U(2,1,t.updatedAt,"dd MMM yyyy, HH:mm:ss")," ")}}function ve(a,o){1&a&&e.nrm(0,"tr",34)}function be(a,o){if(1&a){const t=e.RV6();e.j41(0,"tr",35),e.bIt("click",function(){const s=e.eBV(t).$implicit,n=e.XpG(2);return e.Njj(n.navigateSingleCase(s))}),e.k0s()}}function Se(a,o){if(1&a&&(e.j41(0,"table",16),e.qex(1,17),e.DNE(2,pe,2,0,"th",18)(3,ge,5,1,"td",19),e.bVm(),e.qex(4,20),e.DNE(5,fe,2,0,"th",18)(6,he,3,1,"td",21),e.bVm(),e.qex(7,22),e.DNE(8,_e,2,0,"th",18)(9,Ce,3,4,"td",23),e.bVm(),e.DNE(10,ve,1,0,"tr",24)(11,be,1,0,"tr",25),e.k0s()),2&a){const t=e.XpG();e.Y8G("dataSource",t.dataSource),e.R7$(10),e.Y8G("matHeaderRowDef",t.displayedColumns),e.R7$(),e.Y8G("matRowDefColumns",t.displayedColumns)}}function De(a,o){1&a&&e.nrm(0,"app-content-loader",36),2&a&&e.Y8G("loaderType","table")}function Te(a,o){1&a&&e.nrm(0,"app-content-loader",13),2&a&&e.Y8G("loaderType","paginator")}let Ie=(()=>{class a{constructor(t,i,s,n,d,P,w){this.router=t,this.activatedRoute=i,this.apiService=s,this.alertService=n,this.deleteConfirmDialog=d,this.authService=P,this.fullPageLoaderService=w,this.tableData=[],this.displayedColumns=["id","documents","last_updated"],this.removeDialogTitle="Do you want to remove?",this.messageBodayKey="",this.editRouterLink="",this.resultsLength=0,this.isLoadingResults=!0,this.isLoading=!0,this.isRateLimitReached=!1,this.pageSize=5,this.isAdmin=!1,this.caseId="",this.dataSource=new l.I6}ngOnInit(){this.isAdmin=this.authService.hasRole(g.N.ADMIN)}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.sort&&(this.dataSource.sort=this.sort),this.paginator.page.pipe((0,K.Z)({}),(0,Z.n)(()=>(this.isLoadingResults=!0,this.requestTableData(this.sort?this.sort.active:"case_id",this.sort?this.sort.direction:"asc")))).subscribe(t=>{this.isLoadingResults=!1,this.tableData=t,this.isLoading=!1,this.dataSource=new l.I6(this.tableData)})}requestTableData(t,i){return this.apiService.getAllCasesWithServerSidePagination(this.paginator.pageIndex,this.paginator.pageSize,t,i).pipe((0,Q.T)(s=>(this.resultsLength=s.total,s.data)),(0,j.W)(()=>(this.isLoadingResults=!1,this.isRateLimitReached=!0,[])))}onPageChange(){this.isLoadingResults=!0,this.requestTableData(this.sort?this.sort.active:"case_id",this.sort?this.sort.direction:"asc").subscribe(s=>{this.isLoadingResults=!1,this.resultsLength=s.total,this.dataSource.data=s.data})}applyFilter(t){this.dataSource.filter=t.target.value.trim().toLowerCase()}openDialog(t,i,s){this.deleteConfirmDialog.open(ne,{width:"30%",enterAnimationDuration:t,exitAnimationDuration:i,data:{item:s[this.messageBodayKey],title:this.removeDialogTitle}})}navigateSingleCase(t){console.log(t),this.router.navigate(["/document-managemnt/single-case"],{queryParams:{id:t.id}})}static#e=this.\u0275fac=function(i){return new(i||a)(e.rXU(v.Ix),e.rXU(v.nX),e.rXU(I),e.rXU(G.I),e.rXU(h.bZ),e.rXU(L.u),e.rXU(N.J))};static#t=this.\u0275cmp=e.VBU({type:a,selectors:[["app-case-table-pagination"]],viewQuery:function(i,s){if(1&i&&(e.GBs(re.B4,5),e.GBs(R.iy,5)),2&i){let n;e.mGM(n=e.lsd())&&(s.sort=n.first),e.mGM(n=e.lsd())&&(s.paginator=n.first)}},standalone:!0,features:[e.Jv_([I,u.vh]),e.aNF],decls:13,vars:12,consts:[[1,"cardWithShadow"],[1,"row","justify-content-between","m-l-4","m-r-4"],[1,"col-left"],["appearance","outline","class","w-100 m-b-0","color","primary",4,"ngIf"],[1,"col-right","m-r-30","m-t-2"],[3,"loaderType",4,"ngIf"],["color","primary","mat-stroked-button","",3,"routerLink",4,"ngIf"],[1,"table-responsive"],["mat-table","","class","w-100",3,"dataSource",4,"ngIf"],["style","padding-top: 2px !important;",3,"loaderType",4,"ngIf"],[3,"page","length","pageSize","pageSizeOptions"],["appearance","outline","color","primary",1,"w-100","m-b-0"],["matInput","","placeholder","Filter",3,"keyup"],[3,"loaderType"],["color","primary","mat-stroked-button","",3,"routerLink"],["name","file-plus",1,"icon-28",2,"color","blue"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","class","f-w-600 mat-subtitle-1 f-s-14",4,"matHeaderCellDef"],["mat-cell","","class","mat-body-1",4,"matCellDef"],["matColumnDef","documents"],["mat-cell","",4,"matCellDef"],["matColumnDef","last_updated"],["mat-cell","","class","mat-body-1 f-s-12 f-w-600",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",1,"f-w-600","mat-subtitle-1","f-s-14"],["mat-cell","",1,"mat-body-1"],[1,"d-flex","align-items-center"],[1,"m-l-16"],[1,"mat-body-1","f-s-12","f-w-600"],["mat-cell",""],["name","file-type-pdf",1,"icon-22"],["mat-cell","",1,"mat-body-1","f-s-12","f-w-600"],["mat-header-row",""],["mat-row","",3,"click"],[2,"padding-top","2px !important",3,"loaderType"]],template:function(i,s){1&i&&(e.j41(0,"mat-card",0)(1,"mat-card-content")(2,"div",1)(3,"div",2),e.DNE(4,de,2,0,"mat-form-field",3),e.k0s(),e.j41(5,"div",4),e.DNE(6,me,1,1,"app-content-loader",5)(7,ue,2,1,"button",6),e.k0s()(),e.j41(8,"div",7),e.DNE(9,Se,12,3,"table",8)(10,De,1,1,"app-content-loader",9)(11,Te,1,1,"app-content-loader",5),e.k0s(),e.j41(12,"mat-paginator",10),e.bIt("page",function(){return s.onPageChange()}),e.k0s()()()),2&i&&(e.R7$(4),e.Y8G("ngIf",!s.isLoadingResults),e.R7$(2),e.Y8G("ngIf",s.isLoadingResults),e.R7$(),e.Y8G("ngIf",!s.isLoadingResults),e.R7$(2),e.Y8G("ngIf",!s.isLoadingResults),e.R7$(),e.Y8G("ngIf",s.isLoadingResults),e.R7$(),e.Y8G("ngIf",s.isLoadingResults),e.R7$(),e.xc7("visibility",s.isLoadingResults?"hidden":"visible"),e.Y8G("length",s.resultsLength)("pageSize",s.pageSize)("pageSizeOptions",e.lJ4(11,ce)))},dependencies:[l.tP,l.Zl,l.tL,l.ji,l.cC,l.YV,l.iL,l.KS,l.$R,l.YZ,l.NB,u.MD,u.bT,u.vh,m.Hu,m.RN,m.m2,B.G,F.rl,O.fg,S.$z,R.iy,T.m_,X.Cn,S.Hl,E.mV,D.X4,D.Jc,z.Ph,v.iI,v.Wk,W.y,le.G],styles:[".mat-mdc-row[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]{border-bottom:1px solid transparent;border-top:1px solid transparent;cursor:pointer}.mat-mdc-row[_ngcontent-%COMP%]:hover   .mat-mdc-cell[_ngcontent-%COMP%]{border-color:#43cdf7!important}"]})}return a})(),Fe=(()=>{class a{static#e=this.\u0275fac=function(i){return new(i||a)};static#t=this.\u0275cmp=e.VBU({type:a,selectors:[["app-document-upload"]],standalone:!0,features:[e.aNF],decls:1,vars:0,template:function(i,s){1&i&&e.nrm(0,"app-case-table-pagination")},dependencies:[Ie],encapsulation:2})}return a})();var c=r(9417),J=r(5951),q=r(5024),M=r(2765),ee=r(8617),V=r(850),te=r(6471),$=r(7336),Ae=r(771),Pe=r(2798),we=r(152),xe=r(1985);let Re=(()=>{class a{transform(t,i){if(!t||!i)return t;const s=i.toLowerCase();return t.filter(n=>n.name.toLowerCase().includes(s)||n.email.toLowerCase().includes(s)||n.role.toLowerCase().includes(s))}static#e=this.\u0275fac=function(i){return new(i||a)};static#t=this.\u0275pipe=e.EJ8({name:"userFilter",type:a,pure:!0,standalone:!0})}return a})();var Y=r(5478),y=r(356),p=r(2155),_=function(a){return a.NEW="NEW",a.REMOVED="REMOVED",a.CURRENT="CURRENT",a}(_||{});let ye=(()=>{class a{transform(t,i,s){return t&&0!=i.size?t.filter(n=>s?i.has(n.user_id+"")&&i.get(n.user_id+"")!==_.REMOVED:!i.has(n.user_id+"")||i.get(n.user_id+"")===_.REMOVED):s?[]:t}static#e=this.\u0275fac=function(i){return new(i||a)};static#t=this.\u0275pipe=e.EJ8({name:"userFilterByAccessStatus",type:a,pure:!1,standalone:!0})}return a})();var ie=r(9598),ke=r(6600),b=r(3902);const Ee=()=>[5,10,20],Ue=()=>({standalone:!0});function je(a,o){if(1&a&&(e.j41(0,"mat-option",8),e.EFF(1),e.k0s()),2&a){const t=o.$implicit;e.Y8G("value",t),e.R7$(),e.JRh(t.case_id)}}function Ge(a,o){1&a&&(e.j41(0,"th",29),e.EFF(1," Select "),e.k0s())}function Le(a,o){if(1&a){const t=e.RV6();e.j41(0,"td",30)(1,"mat-radio-button",31),e.bIt("change",function(s){const n=e.eBV(t).$implicit,d=e.XpG(2);return e.Njj(d.onRowSelectionChange(s,n))}),e.k0s()()}if(2&a){const t=o.$implicit,i=e.XpG(2);e.R7$(),e.Y8G("checked",t.document_id===i.currentSelectedDocumentId)("value",t)("aria-label","Select "+t.document_name)}}function Ne(a,o){if(1&a&&(e.j41(0,"td",32)(1,"div",33),e.nrm(2,"i-tabler",34),e.j41(3,"div",35)(4,"div"),e.EFF(5),e.k0s(),e.j41(6,"div",36),e.EFF(7),e.k0s()()()()),2&a){const t=o.$implicit;e.R7$(5),e.JRh(t.document_name),e.R7$(2),e.SpI("",t.file_size,"MB")}}function Oe(a,o){if(1&a){const t=e.RV6();e.j41(0,"div",38)(1,"a",19),e.nrm(2,"i-tabler",39),e.k0s(),e.j41(3,"a",40),e.bIt("click",function(){e.eBV(t);const s=e.XpG().$implicit,n=e.XpG(2);return e.Njj(n.deleteConfirmation(s.document_name))}),e.nrm(4,"i-tabler",41),e.k0s()()}}function Me(a,o){if(1&a&&(e.j41(0,"td",32),e.DNE(1,Oe,5,0,"div",37),e.k0s()),2&a){const t=o.$implicit,i=e.XpG(2);e.R7$(),e.Y8G("ngIf",i.currentSelectedDocumentId===t.document_id)}}function Ve(a,o){1&a&&e.nrm(0,"tr",42)}function $e(a,o){if(1&a){const t=e.RV6();e.j41(0,"mat-list-item",55)(1,"div",56)(2,"app-user-thumbnail",57),e.bIt("clickActionIcon",function(s){e.eBV(t);const n=e.XpG(4);return e.Njj(n.removeAccessWarn(s))}),e.k0s()()()}if(2&a){const t=o.$implicit,i=e.XpG(4);e.R7$(2),e.Y8G("item",t)("hasActionIcon",i.isAdmin)("iconName","circle-minus")("showLabels","CURRENT"!==i.updatedUserIdMap.get(t.user_id+""))("isNew",!0)("iconColor","rgb(219, 10, 59)")}}function Ye(a,o){if(1&a){const t=e.RV6();e.j41(0,"mat-list-item")(1,"div",56)(2,"app-user-thumbnail",57),e.bIt("clickActionIcon",function(s){e.eBV(t);const n=e.XpG(4);return e.Njj(n.giveAccessWarn(s))}),e.k0s()()()}if(2&a){const t=o.$implicit,i=e.XpG(4);e.R7$(2),e.Y8G("item",t)("hasActionIcon",i.isAdmin)("iconName","circle-plus")("showLabels","REMOVED"===i.updatedUserIdMap.get(t.user_id+""))("isNew",!0)("iconColor","rgb(10, 17, 219)")}}function Be(a,o){if(1&a&&(e.j41(0,"div",2)(1,"div",3)(2,"mat-card",1)(3,"mat-card-header")(4,"mat-card-title",51),e.EFF(5),e.nI1(6,"userFilterByAccessStatus"),e.nI1(7,"userFilter"),e.k0s()(),e.j41(8,"mat-card-content")(9,"cdk-virtual-scroll-viewport",52)(10,"mat-list"),e.DNE(11,$e,3,6,"mat-list-item",53),e.nI1(12,"userFilterByAccessStatus"),e.nI1(13,"userFilter"),e.k0s()()()()(),e.j41(14,"div",3)(15,"mat-card",1)(16,"mat-card-header")(17,"mat-card-title",51),e.EFF(18),e.nI1(19,"userFilterByAccessStatus"),e.k0s()(),e.j41(20,"mat-card-content")(21,"cdk-virtual-scroll-viewport",52)(22,"mat-list"),e.DNE(23,Ye,3,6,"mat-list-item",54),e.nI1(24,"userFilterByAccessStatus"),e.nI1(25,"userFilter"),e.k0s()()()()()()),2&a){const t=e.XpG(3);e.R7$(5),e.SpI("Allowed Members (",e.i5U(7,10,e.brH(6,6,t.userTableDataNotAllowed,t.updatedUserIdMap,!0),t.filterText).length,") "),e.R7$(6),e.Y8G("cdkVirtualForOf",e.i5U(13,17,e.brH(12,13,t.userTableDataNotAllowed,t.updatedUserIdMap,!0),t.filterText))("cdkVirtualForTrackBy",t.trackByUserId),e.R7$(7),e.SpI("Not Allowed Members (",e.brH(19,20,t.userTableDataNotAllowed,t.updatedUserIdMap,!1).length,")"),e.R7$(5),e.Y8G("cdkVirtualForOf",e.i5U(25,28,e.brH(24,24,t.userTableDataNotAllowed,t.updatedUserIdMap,!1),t.filterText))("cdkVirtualForTrackBy",t.trackByUserId)}}function Xe(a,o){if(1&a){const t=e.RV6();e.j41(0,"button",58),e.bIt("click",function(){e.eBV(t);const s=e.XpG(3);return e.Njj(s.saveChanges())}),e.EFF(1,"Save Changes"),e.k0s()}if(2&a){const t=e.XpG(3);e.Y8G("disabled",!t.selectedCase)}}function ze(a,o){if(1&a){const t=e.RV6();e.j41(0,"div",2)(1,"div",3)(2,"div",43)(3,"mat-form-field",44)(4,"input",45),e.mxI("ngModelChange",function(s){e.eBV(t);const n=e.XpG(2);return e.DH7(n.filterText,s)||(n.filterText=s),e.Njj(s)}),e.k0s()()()()(),e.DNE(5,Be,26,31,"div",46),e.j41(6,"mat-card-actions",47)(7,"button",48),e.bIt("click",function(){e.eBV(t);const s=e.XpG(2);return e.Njj(s.clickBack())}),e.j41(8,"mat-icon",49),e.EFF(9,"arrow_back"),e.k0s(),e.EFF(10," Back"),e.k0s(),e.DNE(11,Xe,2,1,"button",50),e.k0s()}if(2&a){const t=e.XpG(2);e.R7$(4),e.Y8G("ngModelOptions",e.lJ4(4,Ue)),e.R50("ngModel",t.filterText),e.R7$(),e.Y8G("ngIf",t.isMembersAreaVisibal),e.R7$(6),e.Y8G("ngIf",t.isAdmin)}}function We(a,o){if(1&a){const t=e.RV6();e.j41(0,"mat-card",9)(1,"mat-card-header")(2,"div",10)(3,"div",11)(4,"mat-label",12),e.EFF(5),e.k0s()()()(),e.j41(6,"mat-card-content")(7,"div",13)(8,"mat-form-field",14)(9,"input",15),e.bIt("keyup",function(s){e.eBV(t);const n=e.XpG();return e.Njj(n.applyFilter(s))}),e.k0s()()(),e.j41(10,"div",16)(11,"div",17)(12,"div",2)(13,"div",18),e.nrm(14,"span",19),e.k0s()()(),e.j41(15,"table",20),e.qex(16,21),e.DNE(17,Ge,2,0,"th",22)(18,Le,2,3,"td",23),e.bVm(),e.qex(19,24),e.DNE(20,Ne,8,2,"td",25),e.bVm(),e.qex(21,26),e.DNE(22,Me,2,1,"td",25),e.bVm(),e.DNE(23,Ve,1,0,"tr",27),e.k0s()(),e.nrm(24,"mat-paginator",28),e.k0s()(),e.DNE(25,ze,12,5)}if(2&a){const t=e.XpG();e.R7$(5),e.SpI(" Documents (",t.tableData.length,") "),e.R7$(10),e.Y8G("dataSource",t.dataSource),e.R7$(8),e.Y8G("matRowDefColumns",t.displayedColumns),e.R7$(),e.Y8G("pageSizeOptions",e.lJ4(5,Ee)),e.R7$(),e.vxM(t.currentSelectedDocumentId?25:-1)}}let Je=(()=>{class a{constructor(t,i,s,n,d,P){this.location=t,this.router=i,this.alertService=s,this.authService=n,this.fullPageLoaderService=d,this.apiService=P,this.isMembersAreaVisibal=!1,this.caseId="",this.isReadOnly=!0,this.isLoading=!0,this.myControl=new c.MJ(""),this.isAdmin=!1,this.tableData=[],this.selectData=[],this.userTableDataAllowed=[],this.userTableDataNotAllowed=[],this.filterText="",this.displayedColumns=["select","name","action"],this.selection=new q.CB(!0,[]),this.dataSource=new l.I6,this.removeDialogTitle="Do you want to fremove?",this.messageBodayKey="",this.editRouterLink="",this.caseName="CASE_2012_SPE_15_1",this.caseDescription="Test description",this.isUpload=!1,this.updatedUserIdMap=new Map,this.tempUpdatedUserIdMap=new Map,this.userCurrentMap=new Map,this.currentSelectedDocumentId="",this.deleteConfirmDialog=(0,e.WQX)(h.bZ),this.documentUploadDialog=(0,e.WQX)(h.bZ),this.separatorKeysCodes=[$.Fm,$.KE],this.currentUserOrGroup=(0,e.geq)(""),this.usersOrGroups=(0,e.vPA)([]),this.allUsersOrGroups=(0,e.vPA)([{name:"Dilupa",id:"100WS",isGroup:!1,profile_image:"assets/images/profile/user-1.jpg",email:"test@gmail.com",user:{user_id:"1",name:"Dilupa Marasinghe",email:"test@gmail.com",role:g.N.ADMIN,status:g.z.ACTIVE,created_date:"202-10-27",profile_image:"assets/images/profile/user-1.jpg"}},{name:"CASE November 1 -23",id:"CASE_441_NOV",isGroup:!0,profile_image:"assets/images/profile/user-1.jpg",email:"test@gmail.com",user:null},{name:"CASE Jan 3 -23",id:"CASE_201_NOV",isGroup:!0,profile_image:"assets/images/profile/user-1.jpg",email:"test@gmail.com",user:null},{name:"Randima",id:"102RANWS",isGroup:!1,profile_image:"assets/images/profile/user-1.jpg",email:"test@gmail.com",user:{user_id:"3",name:"Randima Senanayake",email:"test@gmail.com",role:g.N.USER,status:g.z.ACTIVE,created_date:"202-10-27",profile_image:"assets/images/profile/user-3.jpg"}},{name:"CASE Mrch 3 -12",id:"CASE_011_NOV",isGroup:!0,profile_image:"assets/images/profile/user-1.jpg",email:"test@gmail.com",user:null},{name:"Kasun",id:"100KSWS",isGroup:!1,profile_image:"assets/images/profile/user-1.jpg",email:"test@gmail.com",user:{user_id:"5",name:"K.S.C.Janith",email:"test@gmail.com",role:g.N.USER,status:g.z.DEACTIVATED,created_date:"202-10-27",profile_image:"assets/images/profile/user-5.jpg"}}]),this.filteredUsersOrGroups=(0,e.EWP)(()=>{const w=this.currentUserOrGroup().toLowerCase(),x=new Set(this.usersOrGroups().map(f=>f.id));return this.allUsersOrGroups().filter(f=>!x.has(f.id)).filter(f=>f.name.toLowerCase().includes(w))}),this.announcer=(0,e.WQX)(ee.Ai),this.filteredFruits=(0,e.EWP)(()=>{const w=this.currentUserOrGroup().toLowerCase(),x=new Set(this.usersOrGroups().map(f=>f.id));return this.allUsersOrGroups().filter(f=>!x.has(f.id)).filter(f=>f.name.toLowerCase().includes(w))})}ngAfterViewInit(){this.dataSource.paginator=this.paginator}trackByUserId(t,i){return i.user_id}ngOnInit(){this.loadAllUsers(),this.dataSource=new l.I6(this.tableData),this.filteredOptions=this.myControl.valueChanges.pipe((0,K.Z)(""),(0,we.B)(300),(0,Z.n)(t=>this.searchCases(t))),this.isAdmin=this.authService.hasRole(g.N.ADMIN)}searchCases(t){return!t||t.length<2?new xe.c(i=>{i.next([]),i.complete()}):this.apiService.getAllCases(t).pipe((0,Q.T)(i=>i.data))}loadAllCaseData(){if(!this.caseId)return this.isLoading=!0,void console.error("User Id is invalid");this.isReadOnly=!y.q.hasCommonEditPermission(this.authService),this.fullPageLoaderService.setLoadingStatus(!0),this.apiService.getOneCase(this.caseId).subscribe({next:t=>{console.log("Case fetching successful:",t),this.caseData=t.data,this.tableData=this.caseData.documents,this.loadDocumentTableData(),console.log("this.caseData"),console.log(this.caseData),console.log("this.caseData"),this.isLoading=!1},error:t=>{this.fullPageLoaderService.setLoadingStatus(!1),console.error("Case loading failed:",t),t.error.errorCode===p.C.NOT_FOUND?this.alertService.errorAlert("center","Case not found",t.error.message,3e3,!1,"",!1):t.error.errorCode===p.C.ACCESSDENIED?this.alertService.errorAlert("center","You are not permitted to load this case",t.error.message,4e3,!1,"",!1):this.alertService.errorAlert("center","Error while loading case details","",3e3,!1,"",!1),this.router.navigate(["/document-managemnt/document-upload"])},complete:()=>{this.fullPageLoaderService.setLoadingStatus(!1),console.log("Case loading request completed.")}})}loadCaseData(){if(!this.caseId)return this.isLoading=!0,void console.error("User Id is invalid");this.isReadOnly=!y.q.hasCommonEditPermission(this.authService),this.fullPageLoaderService.setLoadingStatus(!0),this.apiService.getOneCase(this.caseId).subscribe({next:t=>{console.log("Case fetching successful:",t),this.caseData=t.data,this.tableData=this.caseData.documents,this.loadDocumentTableData(),console.log("this.caseData"),console.log(this.caseData),console.log("this.caseData"),this.isLoading=!1},error:t=>{this.fullPageLoaderService.setLoadingStatus(!1),console.error("Case loading failed:",t),t.error.errorCode===p.C.NOT_FOUND?this.alertService.errorAlert("center","Case not found",t.error.message,3e3,!1,"",!1):t.error.errorCode===p.C.ACCESSDENIED?this.alertService.errorAlert("center","You are not permitted to load this case",t.error.message,4e3,!1,"",!1):this.alertService.errorAlert("center","Error while loading case details","",3e3,!1,"",!1),this.router.navigate(["/document-managemnt/document-upload"])},complete:()=>{this.fullPageLoaderService.setLoadingStatus(!1),console.log("Case loading request completed.")}})}loadAllUsers(){this.isReadOnly=!y.q.hasCommonEditPermission(this.authService),this.updatedUserIdMap=new Map,this.fullPageLoaderService.setLoadingStatus(!0),this.apiService.getAllUsers().subscribe({next:t=>{console.log("All users fetching successful - Document access:",t),this.userTableDataNotAllowed=t.data,ie.B.getConsitantRandomColorPerUser(this.userTableDataNotAllowed,!0),this.isLoading=!1},error:t=>{this.fullPageLoaderService.setLoadingStatus(!1),console.error("All user loading failed:",t),this.alertService.errorAlert("center","Error while loading user details","",3e3,!1,"",!1)},complete:()=>{this.fullPageLoaderService.setLoadingStatus(!1),console.log("All user details loading request completed.")}})}loadAllowedUsers(t){if(!t)return this.isLoading=!0,void console.error("Document Id is invalid");this.isReadOnly=!y.q.hasCommonEditPermission(this.authService),this.updatedUserIdMap=new Map,this.tempUpdatedUserIdMap=new Map,this.fullPageLoaderService.setLoadingStatus(!0),this.apiService.getAllowedUsersByDocId(t).subscribe({next:i=>{console.log("Document access details fetching successful:",i),this.userTableDataAllowed=i.data,this.userTableDataAllowed.forEach(s=>{this.updatedUserIdMap.set(s.user_id.toString(),_.CURRENT),this.tempUpdatedUserIdMap.set(s.user_id.toString(),_.CURRENT),this.userCurrentMap.set(s.user_id,s),s.user_id=s.user_id+""}),ie.B.getConsitantRandomColorPerUser(this.userTableDataAllowed,!0),console.log("documentId"),console.log(t),console.log("documentId"),this.isLoading=!1,this.isMembersAreaVisibal=!0},error:i=>{this.fullPageLoaderService.setLoadingStatus(!1),console.error("Document access details loading failed:",i),i.error.errorCode===p.C.NOT_FOUND?this.alertService.errorAlert("center","Document ID not found",i.error.message,3e3,!1,"",!1):i.error.errorCode===p.C.ACCESSDENIED?this.alertService.errorAlert("center","You are not permitted to use document access details",i.error.message,4e3,!1,"",!1):this.alertService.errorAlert("center","Error while document access details","",3e3,!1,"",!1),this.updatedUserIdMap=new Map,this.tempUpdatedUserIdMap=new Map,this.userCurrentMap=new Map,this.router.navigate(["/document-managemnt/document-upload"]),this.isMembersAreaVisibal=!1},complete:()=>{this.fullPageLoaderService.setLoadingStatus(!1),console.log("Document access details loading request completed.")}})}loadDocumentTableData(){this.dataSource=new l.I6(this.tableData),this.dataSource.paginator=this.paginator}onRowSelectionChange(t,i){console.log("Selected Row:",i),this.loadAllowedUsers(i.document_id),this.currentSelectedDocumentId=i.document_id}onOptionSelected(t){this.isMembersAreaVisibal=!1,console.log(t.option.value),this.selectedCase=t.option.value,this.caseId=this.selectedCase.id,this.loadCaseData()}onToggleChange(){}backToCase(){this.isUpload=!1}clickBack(){this.location.back()}removeAccessWarn(t){console.log(t),this.alertService.confirmAlert("Are you sure?",`Removing access for this user: ${t.name}`,"warning",!0,"No",!0,"Yes, Proceed",!1,this.removeUserFromAllowedList.bind(this,t))}giveAccessWarn(t){console.log(t),this.alertService.confirmAlert("Are you sure?",`Enabling access for this user: ${t.name}`,"warning",!0,"No",!0,"Yes, Proceed",!1,this.addUserToAllowedMap.bind(this,t))}addUserToAllowedMap(t){const i=t.user_id.toString();this.updatedUserIdMap.has(i)&&this.updatedUserIdMap.get(i)===_.CURRENT||(this.userCurrentMap.has(i)&&this.updatedUserIdMap.set(i,_.CURRENT),this.updatedUserIdMap.has(i)||this.updatedUserIdMap.set(i,_.NEW))}removeUserFromAllowedList(t){const i=t.user_id.toString();!this.updatedUserIdMap.has(i)||this.updatedUserIdMap.get(i)===_.REMOVED||this.updatedUserIdMap.has(i)&&(this.updatedUserIdMap.get(i)===_.NEW?this.updatedUserIdMap.delete(i):this.updatedUserIdMap.set(i,_.REMOVED))}saveChanges(){this.alertService.confirmAlert("Are you sure?","Update access?","warning",!0,"No",!0,"Yes, Proceed",!1,this.updateUserDocumentAccess.bind(this))}updateUserDocumentAccess(){this.fullPageLoaderService.setLoadingStatus(!0);const t=this.currentSelectedDocumentId,i=Array.from(this.updatedUserIdMap.entries()).filter(([s,n])=>n!==_.REMOVED).map(([s])=>s.toString());this.apiService.updateDocumentAccess(i,t).subscribe({next:s=>{console.log("Document access modification successfull:",s),this.alertService.successToster("top-end","The document access settings have been updated successfully",5e3),this.isLoading=!1,this.loadAllowedUsers(t)},error:s=>{this.fullPageLoaderService.setLoadingStatus(!1),console.error("Document access modification  failed:",s),s.error.errorCode===p.C.NOT_FOUND?this.alertService.errorAlert("center","Document not found",s.error.message,3e3,!1,"",!1):s.error.errorCode===p.C.ACCESSDENIED?this.alertService.errorAlert("center","You are not permitted to update the document access",s.error.message,4e3,!1,"",!1):this.alertService.errorAlert("center","Error while updating document access","",3e3,!1,"",!1)},complete:()=>{this.fullPageLoaderService.setLoadingStatus(!1),this.loadAllCaseData(),console.log("Document access modification request completed.")}})}isAllSelected(){return this.selection.selected.length===this.dataSource.data.length}toggleAllRows(){this.isAllSelected()?this.selection.clear():this.selection.select(...this.dataSource.data)}checkboxLabel(t){return t?`${this.selection.isSelected(t)?"deselect":"select"} row ${t.document_id}`:(this.isAllSelected()?"Deselect":"Select")+" all"}applyFilter(t){this.dataSource.filter=t.target.value.trim().toLowerCase()}add(t){const i=(t.value||"").trim();if(i){const s=this.allUsersOrGroups().find(n=>n.name.toLowerCase()===i.toLowerCase());s&&this.usersOrGroups.update(n=>[...n,s])}this.currentUserOrGroup.set("")}remove(t){this.usersOrGroups.update(i=>{const s=i.findIndex(n=>n.id===t.id);return s<0?i:(i.splice(s,1),this.announcer.announce(`Removed ${t.name}`),[...i])}),this.allUsersOrGroups.update(i=>[...i,t]),this.updateFilteredData()}updateFilteredData(){this.filteredUsersOrGroups()}handleBackspace(){if(!this.currentUserOrGroup()){const t=this.usersOrGroups();t.length>0&&this.remove(t[t.length-1])}}selected(t){const i=this.allUsersOrGroups().find(s=>s.name===t.option.value.name);i&&(this.usersOrGroups.update(s=>[...s,i]),this.allUsersOrGroups.update(s=>s.filter(n=>n.id!==i.id))),this.currentUserOrGroup.set("")}openFileUploadDialog(){this.isUpload=!0}_filter(t){const i=t.toLowerCase();return this.selectData.filter(s=>s.case_id.toLowerCase().includes(i))}displayFn(t){return t&&t.case_id?t.case_id:""}deleteConfirmation(t){this.alertService.confirmAlert("Are you sure?",`Do you want to remove this document?  ID: ${t}?`,"warning",!0,"No",!0,"Yes, Proceed",!0,this.removeDocumentCascade.bind(this))}removeDocumentCascade(){this.isReadOnly=!y.q.hasCommonEditPermission(this.authService),this.currentSelectedDocumentId||this.isAdmin||!this.isReadOnly||this.isLoading?(this.fullPageLoaderService.setLoadingStatus(!0),this.apiService.removeDocumentCasecade(this.currentSelectedDocumentId).subscribe({next:t=>{console.log("Document casecade deleation successful:",t),this.alertService.successAlert("center","Document removed successfully","",3e3),this.loadCaseData(),this.loadAllUsers()},error:t=>{this.fullPageLoaderService.setLoadingStatus(!1),console.error("Document casecade deleation failed:",t),this.alertService.errorAlert("center","Failed to remove the Document",t.error.errorCode===p.C.NOT_FOUND||t.error.errorCode===p.C.ACCESSDENIED?t.error.message:"",3e3,!1,"",!1)},complete:()=>{this.fullPageLoaderService.setLoadingStatus(!1),console.log("Document casecade deleation request completed.")}})):console.error("Cannot preceed to remove document")}static#e=this.\u0275fac=function(i){return new(i||a)(e.rXU(u.aZ),e.rXU(v.Ix),e.rXU(G.I),e.rXU(L.u),e.rXU(N.J),e.rXU(I))};static#t=this.\u0275cmp=e.VBU({type:a,selectors:[["app-document-access-table-pagination"]],viewQuery:function(i,s){if(1&i&&e.GBs(R.iy,5),2&i){let n;e.mGM(n=e.lsd())&&(s.paginator=n.first)}},inputs:{currentUserOrGroup:[1,"currentUserOrGroup"]},outputs:{currentUserOrGroup:"currentUserOrGroupChange"},standalone:!0,features:[e.Jv_([I]),e.aNF],decls:15,vars:6,consts:[["auto","matAutocomplete"],[1,"b-1","shadow-none"],[1,"row"],[1,"col-md-6"],[1,"mat-subtitle-2","f-s-14","f-w-600"],["appearance","outline","color","primary",1,"w-100","m-b-0","m-t-2"],["matInput","",3,"formControl","matAutocomplete"],[3,"optionSelected","displayWith"],[3,"value"],[1,"document-card","b-1","shadow-none"],[1,"row","justify-content-between"],[1,"col","p-t-4"],[1,"mat-subtitle-1","f-s-18","f-w-600"],[1,"col-left","col-md-4"],["appearance","outline","color","primary",1,"w-100","m-b-0"],["matInput","","placeholder","Filter",3,"keyup"],[1,"table-responsive"],[1,"justify-content-between"],[1,"col","align-items-start","d-flex","align-items-center","gap-2"],[1,"cursor-pointer"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-cell","","class","mat-body-1",4,"matCellDef"],["matColumnDef","action"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","Select page of periodic elements",3,"pageSizeOptions"],["mat-header-cell",""],["mat-cell",""],[3,"change","checked","value","aria-label"],["mat-cell","",1,"mat-body-1"],[1,"d-flex","align-items-center"],["name","file-type-pdf",1,"icon-20",2,"color","rgb(190, 8, 8)","font-weight","bold"],[1,"d-flex","flex-column"],[2,"font-size","12px","color","gray","line-height","1"],["class","d-flex justify-content-center gap-4",4,"ngIf"],[1,"d-flex","justify-content-center","gap-4"],["name","edit",1,"icon-22"],[1,"cursor-pointer",3,"click"],["name","trash",1,"icon-22",2,"color","red"],["mat-row",""],[1,"col-left","m-b-6"],["appearance","outline","color","primary",1,"w-100","m-b-0",2,"margin-top","-0.06rem !important"],["matInput","","placeholder","Filter",3,"ngModelChange","ngModelOptions","ngModel"],["class","row",4,"ngIf"],["align","start"],["type","button","mat-stroked-button","","color","warn",1,"m-r-10",3,"click"],[2,"font-size","1.4rem"],["mat-flat-button","","color","primary","class","m-r-8",3,"disabled","click",4,"ngIf"],[1,"m-t-8","m-b-0"],["itemSize","10",1,"virtual-scroll-container"],["class","mat-list-item-hover",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],[4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],[1,"mat-list-item-hover"],[1,"row","justify-content-between","m-l-4","m-r-4"],[3,"clickActionIcon","item","hasActionIcon","iconName","showLabels","isNew","iconColor"],["mat-flat-button","","color","primary",1,"m-r-8",3,"click","disabled"]],template:function(i,s){if(1&i){const n=e.RV6();e.j41(0,"mat-card",1)(1,"mat-card-content")(2,"form")(3,"div",2)(4,"div",3)(5,"mat-label",4),e.EFF(6,"Select Case ID"),e.k0s(),e.j41(7,"mat-form-field",5),e.nrm(8,"input",6),e.j41(9,"mat-autocomplete",7,0),e.bIt("optionSelected",function(P){return e.eBV(n),e.Njj(s.onOptionSelected(P))}),e.Z7z(11,je,2,2,"mat-option",8,e.fX1),e.nI1(13,"async"),e.k0s()()()(),e.DNE(14,We,26,6),e.k0s()()()}if(2&i){const n=e.sdS(10);e.R7$(8),e.Y8G("formControl",s.myControl)("matAutocomplete",n),e.R7$(),e.Y8G("displayWith",s.displayFn),e.R7$(2),e.Dyx(e.bMT(13,4,s.filteredOptions)),e.R7$(3),e.vxM(s.selectedCase?14:-1)}},dependencies:[l.tP,l.Zl,l.tL,l.cC,l.YV,l.iL,l.KS,l.$R,l.NB,u.MD,u.bT,u.Jj,c.YN,c.qT,c.me,c.BC,c.cb,c.vS,c.cV,m.Hu,m.RN,m.YY,m.m2,m.MM,m.dh,B.G,V.$3,ke.wT,V.pN,F.rl,F.nJ,O.fg,J._g,b.jt,b.YE,S.$z,T.An,R.iy,T.m_,X.Cn,S.Hl,E.mV,D.X4,D.Jc,z.Ph,v.iI,J.Wk,M.g7,te.YN,V.jL,Ae.D,O.fS,Pe.Ve,c.X1,c.l_,Re,ye,Y.E9,Y.yg,Y.E$,Y.d6,W.y],styles:[".mat-column-select[_ngcontent-%COMP%]{padding-right:0!important}.document-card[_ngcontent-%COMP%]   .mat-mdc-card-header[_ngcontent-%COMP%]{display:inline-block}.virtual-scroll-container[_ngcontent-%COMP%]{height:300px;width:100%;overflow:auto}mat-list-item[_ngcontent-%COMP%]:hover{background:#e5f5ff!important}  mat-list-item:hover .profile-btn-dd{background-color:#e5f5ff!important}mat-list-item[_ngcontent-%COMP%]     i-tabler:hover{height:25px!important;width:25px!important}mat-list-item[_ngcontent-%COMP%]   i-tabler[_ngcontent-%COMP%]{cursor:poiner!important}"]})}return a})(),He=(()=>{class a{static#e=this.\u0275fac=function(i){return new(i||a)};static#t=this.\u0275cmp=e.VBU({type:a,selectors:[["app-document-access"]],standalone:!0,features:[e.aNF],decls:1,vars:0,template:function(i,s){1&i&&e.nrm(0,"app-document-access-table-pagination")},dependencies:[Je],encapsulation:2})}return a})();var Ke=r(7575),H=r(9183),Ze=r(4412);let Qe=(()=>{class a{constructor(){this.uploadProgressSubject=new Ze.t(0),this.uploadProgress$=this.uploadProgressSubject.asObservable()}uploadFiles(t,i,s){const n=new FormData;return i.forEach(d=>{n.append("files",d,d.name)}),s.fileBatchUpload(t,n).pipe((0,j.W)(d=>{throw console.error("Error during file upload:",d),d}))}static#e=this.\u0275fac=function(i){return new(i||a)};static#t=this.\u0275prov=e.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();var qe=r(1997);function et(a,o){if(1&a){const t=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"div",7),e.bIt("drop",function(s){e.eBV(t);const n=e.XpG();return e.Njj(n.onDrop(s))})("dragover",function(s){return e.eBV(t),e.Njj(s.preventDefault())})("click",function(){e.eBV(t);const s=e.sdS(8);return e.Njj(s.click())}),e.j41(3,"mat-icon",8),e.EFF(4,"cloud_upload"),e.k0s(),e.j41(5,"span"),e.EFF(6,"Drag and drop here or click to upload"),e.k0s(),e.j41(7,"input",9,0),e.bIt("change",function(s){e.eBV(t);const n=e.XpG();return e.Njj(n.onFileInputChange(s))}),e.k0s()()()()}}function tt(a,o){if(1&a){const t=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"div",10),e.nrm(3,"mat-spinner"),e.j41(4,"span"),e.EFF(5,"Uploading in progress..."),e.k0s(),e.j41(6,"input",9,0),e.bIt("change",function(s){e.eBV(t);const n=e.XpG();return e.Njj(n.onFileInputChange(s))}),e.k0s()()()()}}function it(a,o){if(1&a){const t=e.RV6();e.j41(0,"div",24),e.bIt("click",function(){e.eBV(t);const s=e.XpG().index,n=e.XpG(2);return e.Njj(n.removeFile(s))}),e.j41(1,"mat-icon",25),e.EFF(2,"clear"),e.k0s()()}}function at(a,o){1&a&&(e.j41(0,"div",26)(1,"mat-icon"),e.nrm(2,"mat-spinner",27),e.k0s()())}function st(a,o){1&a&&(e.j41(0,"div",28)(1,"mat-icon",29),e.EFF(2,"cloud_done"),e.k0s()())}function nt(a,o){if(1&a&&(e.j41(0,"mat-list-item")(1,"div",3)(2,"div",16)(3,"mat-icon",17),e.EFF(4,"description"),e.k0s()(),e.j41(5,"div",18)(6,"div",19),e.EFF(7),e.k0s(),e.j41(8,"div",20),e.EFF(9),e.nI1(10,"date"),e.k0s()(),e.DNE(11,it,3,0,"div",21)(12,at,3,0,"div",22)(13,st,3,0,"div",23),e.k0s()()),2&a){const t=o.$implicit,i=e.XpG(2);e.R7$(7),e.JRh(t.name),e.R7$(2),e.JRh(e.bMT(10,5,t.lastModified)),e.R7$(2),e.Y8G("ngIf",!i.progressStarted),e.R7$(),e.Y8G("ngIf",i.progressStarted),e.R7$(),e.Y8G("ngIf",!1)}}function ot(a,o){if(1&a&&(e.j41(0,"div",11)(1,"div",12),e.EFF(2,"CASE_2024_NOV-21 "),e.j41(3,"span",13),e.EFF(4),e.k0s()(),e.nrm(5,"mat-divider"),e.j41(6,"mat-list",14),e.DNE(7,nt,14,7,"mat-list-item",15),e.k0s()()),2&a){const t=e.XpG();e.R7$(4),e.SpI("(",t.files.length," Selected)"),e.R7$(2),e.Y8G("disabled",t.progressStarted),e.R7$(),e.Y8G("ngForOf",t.files)}}function rt(a,o){if(1&a){const t=e.RV6();e.j41(0,"button",32),e.bIt("click",function(){e.eBV(t);const s=e.XpG(2);return e.Njj(s.startProgressUpload())}),e.EFF(1,"Start Upload"),e.k0s()}}function lt(a,o){1&a&&(e.j41(0,"button",33),e.EFF(1,"Disabled"),e.k0s())}function ct(a,o){if(1&a&&(e.qex(0),e.DNE(1,rt,2,0,"button",30)(2,lt,2,0,"button",31),e.bVm()),2&a){const t=e.XpG();e.R7$(),e.Y8G("ngIf",!t.progressStarted),e.R7$(),e.Y8G("ngIf",t.progressStarted)}}let dt=(()=>{class a{constructor(t,i,s,n,d){this.router=t,this.fileUploadService=i,this.componentApiService=s,this.alertService=n,this.fullPageLoaderService=d,this.caseId="",this.backToCaseDetails=new e.bkB,this.progressStarted=!1,this.files=[],this.progress=0}ngOnInit(){}onDrop(t){t.preventDefault();const i=t.dataTransfer?.files;i&&this.addFiles(i)}onFileInputChange(t){const i=t.target;i&&i.files&&this.addFiles(i.files)}addFiles(t){for(let i=0;i<t.length;i++)this.files.push(t[i])}startUpload(){}uploadFiles(){this.files.length>0?(this.fullPageLoaderService.setLoadingStatus(!0),this.fileUploadService.uploadFiles(this.caseId,Array.from(this.files),this.componentApiService).subscribe({next:t=>{if(t.type===U.hv.Response){const i={id:this.caseId};this.fullPageLoaderService.setLoadingStatus(!1),console.log("Upload successful:",t.body?.message),this.alertService.successAlert("center","File upload success","",3e3,!0,!0,!0),this.router.navigate(["/document-managemnt/single-case"],{queryParams:i}),this.progressStarted=!1,this.backToCaseDetails.emit(!0)}},error:t=>{this.fullPageLoaderService.setLoadingStatus(!1),console.error("Upload failed:",t),this.alertService.errorAlert("center","Faill to upload files","",3e3,!1,"",!1),this.progressStarted=!1,this.backToCaseDetails.emit(!0)},complete:()=>{this.fullPageLoaderService.setLoadingStatus(!1),this.progressStarted=!1}})):console.error("No files selected")}removeFile(t){this.files.splice(t,1)}startProgressUpload(){this.progressStarted=!0,this.uploadFiles()}getProgress(t){}static#e=this.\u0275fac=function(i){return new(i||a)(e.rXU(v.Ix),e.rXU(Qe),e.rXU(I),e.rXU(G.I),e.rXU(N.J))};static#t=this.\u0275cmp=e.VBU({type:a,selectors:[["app-file-upload-ui"]],inputs:{caseId:"caseId"},outputs:{backToCaseDetails:"backToCaseDetails"},standalone:!0,features:[e.aNF],decls:9,vars:4,consts:[["fileInput",""],[1,"container"],["class","row",4,"ngIf"],[1,"row"],[1,"col"],["class","files-list-section mb-4 w-100",4,"ngIf"],[4,"ngIf"],[1,"upload-area",3,"drop","dragover","click"],[1,"upload-icon","mb-2",2,"font-size","48px"],["type","file","multiple","","hidden","",3,"change"],[1,"upload-area","upload-area-desabled"],[1,"files-list-section","mb-4","w-100"],["mat-subheader",""],[2,"font-size","small"],[1,"file-list",3,"disabled"],[4,"ngFor","ngForOf"],[1,"col-md-1","col-sm-1"],["matListItemIcon",""],[1,"col-md-9"],["matListItemTitle",""],["matListItemLine",""],["class","col-md-2",3,"click",4,"ngIf"],["style","padding-top: 15px;","class","col-md-2",4,"ngIf"],["class","col-md-2",4,"ngIf"],[1,"col-md-2",3,"click"],["matListItemIcon","",1,"cursor-pointer"],[1,"col-md-2",2,"padding-top","15px"],["color","accent","diameter","20"],[1,"col-md-2"],["matListItemIcon","",2,"color","rgb(4, 207, 7)"],["mat-raised-button","","color","primary","class","mt-3 w-100",3,"click",4,"ngIf"],["mat-stroked-button","","disabled","",4,"ngIf"],["mat-raised-button","","color","primary",1,"mt-3","w-100",3,"click"],["mat-stroked-button","","disabled",""]],template:function(i,s){1&i&&(e.j41(0,"div",1),e.DNE(1,et,9,0,"div",2)(2,tt,8,0,"div",2),e.j41(3,"div",3)(4,"div",4),e.DNE(5,ot,8,3,"div",5),e.k0s()(),e.j41(6,"div",3)(7,"div",4),e.DNE(8,ct,3,2,"ng-container",6),e.k0s()()()),2&i&&(e.R7$(),e.Y8G("ngIf",!s.progressStarted),e.R7$(),e.Y8G("ngIf",s.progressStarted),e.R7$(3),e.Y8G("ngIf",s.files.length>0),e.R7$(3),e.Y8G("ngIf",s.files.length>0))},dependencies:[u.MD,u.Sq,u.bT,u.vh,T.m_,T.An,h.hM,Ke.PO,M.g7,b.Fg,b.jt,b.YE,b.ZV,b.EI,qe.q,b.C_,b.yE,D.X4,H.LG],styles:[".container[_ngcontent-%COMP%]{width:50vw;max-width:100%;padding:0;margin:0;box-sizing:border-box}h1.mat-dialog-title[_ngcontent-%COMP%]{font-size:24px;color:#2196f3;text-align:center;margin-bottom:20px}.description[_ngcontent-%COMP%]{font-size:16px;text-align:center;margin-bottom:30px;color:#424242}.upload-area-desabled[_ngcontent-%COMP%]{border:2px dashed #4e5052!important;background-color:#ebf2f7!important}.upload-area[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;padding:50px;background-color:#f1f8ff;border-radius:8px;border:2px dashed #2196f3;cursor:pointer;transition:border-color .3s ease;text-align:center;min-height:300px;width:100%;box-sizing:border-box}.upload-area[_ngcontent-%COMP%]:hover{border-color:#1976d2}.upload-area[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:60px;color:#1976d2;margin-bottom:10px}.upload-area[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px;color:#424242}.row[_ngcontent-%COMP%], .col[_ngcontent-%COMP%]{width:100%;max-width:100%;margin:0;padding:0;box-sizing:border-box}.file-list[_ngcontent-%COMP%]{flex-direction:column;margin-bottom:20px;overflow-y:auto;max-height:300px;width:100%}.file-list[_ngcontent-%COMP%]   .mdc-list-item__primary-text[_ngcontent-%COMP%]{font-size:small}.file-list[_ngcontent-%COMP%]   .mdc-list-item__secondary-text[_ngcontent-%COMP%]{font-size:smaller}.files-list-section[_ngcontent-%COMP%]{display:ruby}button[mat-raised-button][_ngcontent-%COMP%]{padding:12px 24px;font-size:16px;background-color:#2196f3;color:#fff;border-radius:8px;margin-top:20px;width:100%;transition:background-color .3s ease;border:none}button[mat-raised-button][_ngcontent-%COMP%]:hover{background-color:#1976d2}button[mat-stroked-button][_ngcontent-%COMP%]{padding:12px 24px;font-size:16px;background-color:#2092ec54!important;border-radius:8px;margin-top:20px;width:100%;transition:background-color .3s ease;border:none}@media (max-width: 600px){mat-dialog-content[_ngcontent-%COMP%]{padding:10px;min-width:100%}.upload-area[_ngcontent-%COMP%]{padding:20px;min-height:250px}.upload-area[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:10px;color:#424242}.file-list[_ngcontent-%COMP%]{max-height:250px}.file-list-item[_ngcontent-%COMP%]{font-size:12px;padding:8px}.file-card[_ngcontent-%COMP%]{padding:12px;flex-direction:column;align-items:flex-start}.file-list-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px}.file-list-item[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%], span[_ngcontent-%COMP%]{font-size:16px}button[mat-raised-button][_ngcontent-%COMP%]{padding:10px 20px;font-size:14px}}@media (min-width: 601px){.upload-area[_ngcontent-%COMP%]{padding:40px;min-height:280px}}@media (min-width: 769px){mat-dialog-content[_ngcontent-%COMP%]{padding:20px;min-width:500px;min-height:360px}.upload-area[_ngcontent-%COMP%]{padding:40px;min-height:180px}.file-card[_ngcontent-%COMP%]{padding:15px}button[mat-raised-button][_ngcontent-%COMP%]{padding:12px 24px;font-size:16px}.upload-icon[_ngcontent-%COMP%]{font-size:100px!important;display:contents!important}}"]})}return a})();var A=r(9454);const mt=()=>[5,10,20],ut=a=>({"highlight-download":a});function pt(a,o){1&a&&e.nrm(0,"i-tabler",16)}function gt(a,o){1&a&&(e.j41(0,"mat-error"),e.EFF(1," Case ID is required. "),e.k0s())}function ft(a,o){1&a&&(e.j41(0,"mat-error"),e.EFF(1," Case ID must be at least 3 characters long. "),e.k0s())}function ht(a,o){1&a&&(e.j41(0,"mat-error"),e.EFF(1," Case ID cannot exceed 50 characters. "),e.k0s())}function _t(a,o){1&a&&e.nrm(0,"i-tabler",16)}function Ct(a,o){1&a&&(e.j41(0,"mat-error"),e.EFF(1," Name cannot exceed 300 characters. "),e.k0s())}function vt(a,o){if(1&a){const t=e.RV6();e.j41(0,"mat-card-actions",17)(1,"button",18),e.bIt("click",function(){e.eBV(t);const s=e.XpG(2);return e.Njj(s.clickBack())}),e.j41(2,"mat-icon",19),e.EFF(3,"arrow_back"),e.k0s(),e.EFF(4," Back"),e.k0s(),e.j41(5,"button",20),e.bIt("click",function(){e.eBV(t);const s=e.XpG(2);return e.Njj(s.clickCreateCase())}),e.EFF(6,"Save This"),e.k0s()()}if(2&a){const t=e.XpG(2);e.R7$(5),e.Y8G("disabled",t.form.invalid||t.isReadOnly)}}function bt(a,o){if(1&a&&(e.j41(0,"div",4)(1,"div",5)(2,"mat-card",7)(3,"mat-card-content")(4,"form",8)(5,"div",4)(6,"div",5)(7,"mat-label",9),e.DNE(8,pt,1,0,"i-tabler",10),e.EFF(9," Case ID "),e.k0s(),e.j41(10,"mat-form-field",11),e.nrm(11,"input",12),e.DNE(12,gt,2,0,"mat-error",13)(13,ft,2,0,"mat-error",13)(14,ht,2,0,"mat-error",13),e.k0s()(),e.j41(15,"div",5)(16,"mat-label",9),e.DNE(17,_t,1,0,"i-tabler",10),e.EFF(18," Description"),e.k0s(),e.j41(19,"mat-form-field",11),e.nrm(20,"textarea",14),e.DNE(21,Ct,2,0,"mat-error",13),e.k0s()()(),e.DNE(22,vt,7,1,"mat-card-actions",15),e.k0s()()()()()),2&a){const t=e.XpG();e.R7$(4),e.Y8G("formGroup",t.form),e.R7$(4),e.Y8G("ngIf",!t.isAdmin),e.R7$(3),e.Y8G("disabled",!t.isAdmin),e.R7$(),e.Y8G("ngIf",t.f.case_id.hasError("required")&&(t.f.case_id.touched||t.f.case_id.dirty)),e.R7$(),e.Y8G("ngIf",t.f.case_id.hasError("minlength")&&(t.f.case_id.touched||t.f.case_id.dirty)),e.R7$(),e.Y8G("ngIf",t.f.case_id.hasError("maxlength")&&(t.f.case_id.touched||t.f.case_id.dirty)),e.R7$(3),e.Y8G("ngIf",!t.isAdmin),e.R7$(3),e.Y8G("disabled",!t.isAdmin),e.R7$(),e.Y8G("ngIf",t.f.description.hasError("maxlength")&&(t.f.description.touched||t.f.description.dirty)),e.R7$(),e.Y8G("ngIf",t.isAdmin)}}function St(a,o){if(1&a){const t=e.RV6();e.j41(0,"div",21)(1,"button",22),e.bIt("click",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.backToCase())}),e.j41(2,"mat-icon",19),e.EFF(3,"arrow_back"),e.k0s()(),e.j41(4,"app-file-upload-ui",23),e.bIt("backToCaseDetails",function(s){e.eBV(t);const n=e.XpG();return e.Njj(n.handleBackToCaseDetailsEvent(s))}),e.k0s()()}if(2&a){const t=e.XpG();e.R7$(4),e.Y8G("caseId",t.caseId)}}function Dt(a,o){if(1&a){const t=e.RV6();e.j41(0,"div",30)(1,"button",35),e.bIt("click",function(){e.eBV(t);const s=e.XpG(3);return e.Njj(s.openFileUploadDialog())}),e.j41(2,"mat-icon",36),e.EFF(3,"upload_file"),e.k0s(),e.EFF(4," Upload Files "),e.k0s()()}if(2&a){const t=e.XpG(3);e.R7$(),e.Y8G("disabled",t.enableDownloadSelected||t.isReadOnly)}}function Tt(a,o){if(1&a){const t=e.RV6();e.qex(0),e.j41(1,"button",37),e.bIt("click",function(){e.eBV(t);const s=e.XpG(3);return e.Njj(s.downloadConfirm())}),e.j41(2,"mat-icon",38),e.EFF(3,"download_file"),e.k0s(),e.EFF(4," Download Files "),e.k0s(),e.bVm()}if(2&a){const t=e.XpG(3);e.R7$(),e.Y8G("ngClass",e.eq3(2,ut,t.selection.hasValue()&&t.selection.selected.length<=5))("disabled",!(t.selection.hasValue()&&t.selection.selected.length<=5))}}function It(a,o){1&a&&(e.j41(0,"button",39)(1,"mat-icon"),e.nrm(2,"mat-spinner",40),e.k0s(),e.EFF(3," Download Files "),e.k0s()),2&a&&e.Y8G("disabled",!0)}function Ft(a,o){if(1&a){const t=e.RV6();e.j41(0,"div",41)(1,"mat-form-field",42)(2,"input",43),e.bIt("keyup",function(s){e.eBV(t);const n=e.XpG(3);return e.Njj(n.applyFilter(s))}),e.k0s()()()}}function At(a,o){if(1&a){const t=e.RV6();e.j41(0,"th",55)(1,"mat-checkbox",56),e.bIt("change",function(s){e.eBV(t);const n=e.XpG(4);return e.Njj(s?n.toggleAllRows():null)}),e.k0s()()}if(2&a){const t=e.XpG(4);e.R7$(),e.Y8G("checked",t.selection.hasValue()&&t.isAllSelected())("indeterminate",t.selection.hasValue()&&!t.isAllSelected())("aria-label",t.checkboxLabel())}}function Pt(a,o){if(1&a){const t=e.RV6();e.j41(0,"td",57)(1,"mat-checkbox",58),e.bIt("click",function(s){return e.eBV(t),e.Njj(s.stopPropagation())})("change",function(s){const n=e.eBV(t).$implicit,d=e.XpG(4);return e.Njj(s?d.selection.toggle(n):null)}),e.k0s()()}if(2&a){const t=o.$implicit,i=e.XpG(4);e.R7$(),e.Y8G("checked",i.selection.isSelected(t))("aria-label",i.checkboxLabel(t))}}function wt(a,o){if(1&a&&(e.j41(0,"td",59)(1,"div",60),e.nrm(2,"i-tabler",61),e.j41(3,"div",62)(4,"div"),e.EFF(5),e.k0s(),e.j41(6,"div",63),e.EFF(7),e.k0s()()()()),2&a){const t=o.$implicit;e.R7$(5),e.JRh(t.document_name),e.R7$(2),e.SpI("",t.file_size,"MB")}}function xt(a,o){1&a&&(e.j41(0,"a",66),e.nrm(1,"i-tabler",67),e.k0s())}function Rt(a,o){if(1&a){const t=e.RV6();e.j41(0,"a",66)(1,"i-tabler",68),e.bIt("click",function(){e.eBV(t);const s=e.XpG(5);return e.Njj(s.deleteDocumentConfirmation())}),e.k0s()()}}function yt(a,o){1&a&&(e.j41(0,"a",66),e.nrm(1,"i-tabler",69),e.k0s())}function kt(a,o){if(1&a&&(e.j41(0,"td",59)(1,"div",64),e.DNE(2,xt,2,0,"a",65)(3,Rt,2,0,"a",65)(4,yt,2,0,"a",65),e.k0s()()),2&a){const t=e.XpG(4);e.R7$(2),e.Y8G("ngIf",t.isAdmin),e.R7$(),e.Y8G("ngIf",t.isAdmin),e.R7$(),e.Y8G("ngIf",!t.isAdmin)}}function Et(a,o){1&a&&e.nrm(0,"tr",70)}function Ut(a,o){if(1&a&&(e.j41(0,"div",44)(1,"div",45)(2,"div",4),e.nrm(3,"div",46),e.k0s()(),e.j41(4,"table",47),e.qex(5,48),e.DNE(6,At,2,3,"th",49)(7,Pt,2,2,"td",50),e.bVm(),e.qex(8,51),e.DNE(9,wt,8,2,"td",52),e.bVm(),e.qex(10,53),e.DNE(11,kt,5,3,"td",52),e.bVm(),e.DNE(12,Et,1,0,"tr",54),e.k0s()()),2&a){const t=e.XpG(3);e.R7$(4),e.Y8G("dataSource",t.dataSource),e.R7$(8),e.Y8G("matRowDefColumns",t.displayedColumns)}}function jt(a,o){if(1&a&&(e.j41(0,"div",5)(1,"mat-card",25)(2,"mat-card-header")(3,"div",26)(4,"div",27)(5,"mat-label",28),e.EFF(6),e.k0s()()(),e.j41(7,"div",26),e.DNE(8,Dt,5,1,"div",29),e.j41(9,"div",30),e.DNE(10,Tt,5,4,"ng-container",13)(11,It,4,1,"button",31),e.k0s()()(),e.j41(12,"mat-card-content"),e.DNE(13,Ft,3,0,"div",32)(14,Ut,13,2,"div",33),e.nrm(15,"mat-paginator",34),e.k0s()()()),2&a){const t=e.XpG(2);e.R7$(6),e.SpI(" Documents (",t.documentTableData.length,") "),e.R7$(2),e.Y8G("ngIf",t.isAdmin),e.R7$(2),e.Y8G("ngIf",!t.enableDownloadSelected),e.R7$(),e.Y8G("ngIf",t.enableDownloadSelected),e.R7$(2),e.Y8G("ngIf",!t.isCaseCreation),e.R7$(),e.Y8G("ngIf",!t.isCaseCreation),e.R7$(),e.Y8G("pageSizeOptions",e.lJ4(7,mt))}}function Gt(a,o){if(1&a&&(e.j41(0,"div",4),e.DNE(1,jt,16,8,"div",24),e.k0s()),2&a){const t=e.XpG();e.R7$(),e.Y8G("ngIf",!t.isCaseCreation)}}function Lt(a,o){if(1&a){const t=e.RV6();e.j41(0,"button",75),e.bIt("click",function(){e.eBV(t);const s=e.XpG(2);return e.Njj(s.deleteConfirmation())}),e.EFF(1,"Delete"),e.k0s()}if(2&a){const t=e.XpG(2);e.Y8G("disabled",t.isReadOnly)}}function Nt(a,o){if(1&a&&(e.j41(0,"mat-accordion",71)(1,"mat-expansion-panel",72)(2,"mat-expansion-panel-header")(3,"mat-panel-title"),e.EFF(4," Remove This Case "),e.j41(5,"mat-icon"),e.EFF(6,"delete"),e.k0s()()(),e.j41(7,"mat-panel-description",73),e.DNE(8,Lt,2,1,"button",74),e.k0s()()()),2&a){const t=e.XpG();e.R7$(),e.Y8G("expanded",!1),e.R7$(7),e.Y8G("ngIf",!t.isCaseCreation)}}let Ot=(()=>{class a{constructor(t,i,s,n,d,P,w){this.location=t,this.router=i,this.activatedRoute=s,this.alertService=n,this.apiService=d,this.authService=P,this.fullPageLoaderService=w,this.isAdmin=!1,this.caseId="",this.isCaseCreation=!1,this.isReadOnly=!0,this.isLoading=!0,this.documentTableData=[],this.displayedColumns=["select","document_name","action"],this.selection=new q.CB(!0,[]),this.enableDownloadSelected=!1,this.dataSource=new l.I6,this.removeDialogTitle="Do you want to remove?",this.messageBodayKey="",this.editRouterLink="",this.caseName="CASE_2012_SPE_15_1",this.caseDescription="Test description",this.isUpload=!1,this.selectedFilesList=[],this.deleteConfirmDialog=(0,e.WQX)(h.bZ),this.documentUploadDialog=(0,e.WQX)(h.bZ),this.separatorKeysCodes=[$.Fm,$.KE],this.currentUserOrGroup=(0,e.geq)(""),this.usersOrGroups=(0,e.vPA)([]),this.allUsersOrGroups=(0,e.vPA)([{name:"Dilupa",id:"100WS",isGroup:!1,profile_image:"assets/images/profile/user-1.jpg",email:"test@gmail.com",user:{user_id:"1",name:"Dilupa Marasinghe",email:"test@gmail.com",role:g.N.ADMIN,status:g.z.ACTIVE,created_date:"202-10-27",profile_image:"assets/images/profile/user-1.jpg"}},{name:"CASE November 1 -23",id:"CASE_441_NOV",isGroup:!0,profile_image:"assets/images/profile/user-1.jpg",email:"test@gmail.com",user:null},{name:"CASE Jan 3 -23",id:"CASE_201_NOV",isGroup:!0,profile_image:"assets/images/profile/user-1.jpg",email:"test@gmail.com",user:null},{name:"Randima",id:"102RANWS",isGroup:!1,profile_image:"assets/images/profile/user-1.jpg",email:"test@gmail.com",user:{user_id:"3",name:"Randima Senanayake",email:"test@gmail.com",role:g.N.USER,status:g.z.ACTIVE,created_date:"202-10-27",profile_image:"assets/images/profile/user-3.jpg"}},{name:"CASE Mrch 3 -12",id:"CASE_011_NOV",isGroup:!0,profile_image:"assets/images/profile/user-1.jpg",email:"test@gmail.com",user:null},{name:"Kasun",id:"100KSWS",isGroup:!1,profile_image:"assets/images/profile/user-1.jpg",email:"test@gmail.com",user:{user_id:"5",name:"K.S.C.Janith",email:"test@gmail.com",role:g.N.USER,status:g.z.DEACTIVATED,created_date:"202-10-27",profile_image:"assets/images/profile/user-5.jpg"}}]),this.filteredUsersOrGroups=(0,e.EWP)(()=>{const x=this.currentUserOrGroup().toLowerCase(),f=new Set(this.usersOrGroups().map(C=>C.id));return this.allUsersOrGroups().filter(C=>!f.has(C.id)).filter(C=>C.name.toLowerCase().includes(x))}),this.announcer=(0,e.WQX)(ee.Ai),this.http=(0,e.WQX)(U.Qq),this.filteredFruits=(0,e.EWP)(()=>{const x=this.currentUserOrGroup().toLowerCase(),f=new Set(this.usersOrGroups().map(C=>C.id));return this.allUsersOrGroups().filter(C=>!f.has(C.id)).filter(C=>C.name.toLowerCase().includes(x))}),this.form=new c.gE({case_id:new c.MJ("",[c.k0.required,c.k0.minLength(3),c.k0.maxLength(50)]),description:new c.MJ("",[c.k0.maxLength(300)])})}get f(){return this.form.controls}ngAfterViewInit(){this.dataSource.paginator=this.paginator}ngOnInit(){this.isAdmin=this.authService.hasRole(g.N.ADMIN),!this.isAdmin&&this.form&&(this.f.case_id.disable(),this.f.description.disable()),this.enableDesableFrom(!this.isAdmin),this.isReadOnly=!this.isAdmin,this.activatedRoute.queryParams.subscribe(t=>{t.id&&(this.caseId=t.id,this.loadCaseData())})}onToggleChange(){this.isAdmin?(this.f.case_id.enable(),this.f.description.enable()):(this.f.case_id.disable(),this.f.description.disable())}backToCase(){this.isUpload=!1}handleBackToCaseDetailsEvent(t){t&&(this.isUpload=!1,this.loadCaseData())}isAllSelected(){return this.selection.selected.length===this.dataSource.data.length}toggleAllRows(){this.isAllSelected()?this.selection.clear():this.selection.select(...this.dataSource.data)}downloadConfirm(){if(this.selection.selected.length>0){const t=this.selection.selected.map(s=>s.document_name),i=this.generateHtmlList(t);this.alertService.confirmAlertWithHtml("Do you want to download below documents?",i,"warning",!0,"No",!0,"Yes, Proceed",!1,this.downloadSelected.bind(this))}}downloadConfirmForIconClick(t,i){if(t&&i){const n=this.generateHtmlList([i]);this.alertService.confirmAlertWithHtml("Do you want to download below documents?",n,"warning",!0,"No",!0,"Yes, Proceed",!1,this.sendSingleFileDownloadRequest.bind(this,t,i))}}generateHtmlList(t){return`<ul style="list-style-type: decimal; text-align: start !important;">\n    ${t.map(i=>`<li>${i}</li>`).join("")}\n  </ul>`}downloadSelected(){1===this.selection.selected.length?this.selection.selected[0].file_url&&this.sendSingleFileDownloadRequest(this.selection.selected[0].file_url,this.selection.selected[0].document_name):this.selection.selected.length>1?(console.log(this.selection.selected),this.sendBatchDownloadRequest()):this.alertService.errorToaster("top-end","Please select documents to download")}checkboxLabel(t){return t?`${this.selection.isSelected(t)?"deselect":"select"} row ${t.document_id}`:(this.isAllSelected()?"Deselect":"Select")+" all"}applyFilter(t){this.dataSource.filter=t.target.value.trim().toLowerCase()}add(t){const i=(t.value||"").trim();if(i){const s=this.allUsersOrGroups().find(n=>n.name.toLowerCase()===i.toLowerCase());s&&this.usersOrGroups.update(n=>[...n,s])}this.currentUserOrGroup.set("")}updateFilteredData(){this.filteredUsersOrGroups()}handleBackspace(){if(!this.currentUserOrGroup()){this.usersOrGroups()}}selected(t){const i=this.allUsersOrGroups().find(s=>s.name===t.option.value.name);i&&(this.usersOrGroups.update(s=>[...s,i]),this.allUsersOrGroups.update(s=>s.filter(n=>n.id!==i.id))),this.currentUserOrGroup.set("")}openFileUploadDialog(){this.isReadOnly||this.enableDownloadSelected||(this.isUpload=!0)}sendBatchDownloadRequest(){this.selectedFilesList=[],this.selectedFilesList=this.selection.selected.map(t=>t.file_url),this.fullPageLoaderService.setLoadingStatus(!0),this.apiService.fileBatchDownload(this.caseId,this.selectedFilesList).pipe((0,j.W)(t=>{throw console.error("Error during file download:",t),this.fullPageLoaderService.setLoadingStatus(!1),this.alertService.errorToaster("top-end","An error occurred. Please try again later."),t})).subscribe({next:t=>{this.fullPageLoaderService.setLoadingStatus(!1),this.alertService.successToster("center","Your download will begin now.",3e3),this.downloadFile(t)},error:t=>{this.fullPageLoaderService.setLoadingStatus(!1),this.alertService.errorToaster("top-end","An error occurred. Please try again later."),console.error("Error in subscription:",t)},complete:()=>{this.fullPageLoaderService.setLoadingStatus(!1),console.log("Batch download request completed.")}})}sendSingleFileDownloadRequest(t,i){this.fullPageLoaderService.setLoadingStatus(!0),this.apiService.singleFileDownload(this.caseId,t).pipe((0,j.W)(s=>{throw console.error("Error during single file download:",s),this.fullPageLoaderService.setLoadingStatus(!1),this.alertService.errorToaster("top-end","An error occurred. Please try again later."),s})).subscribe({next:s=>{this.alertService.successToster("center","Your file download is starting now.",3e3),this.fullPageLoaderService.setLoadingStatus(!1),this.downloadSingleFile(s,i)},error:s=>{this.fullPageLoaderService.setLoadingStatus(!1),this.alertService.errorToaster("top-end","An error occurred. Please try again later."),console.error("Error in subscription:",s)},complete:()=>{this.fullPageLoaderService.setLoadingStatus(!1),console.log("Single file download request completed.")}})}downloadFile(t){const i=new Blob([t],{type:"application/zip"}),s=window.URL.createObjectURL(i),n=document.createElement("a");n.href=s,n.download="batch-files.zip",n.click(),window.URL.revokeObjectURL(s)}downloadSingleFile(t,i){const s=window.URL.createObjectURL(t),n=document.createElement("a");n.href=s,n.download=i,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(s)}deleteDocumentConfirmation(){this.alertService.confirmAlert("Are you sure?",`Do you want to remove this document?  ID: ${this.selection.selected[0].document_id}?`,"warning",!0,"No",!0,"Yes, Proceed",!0,this.removeDocument.bind(this))}deleteConfirmation(){this.alertService.confirmAlert("Are you sure?",`Do you want to remove this Case?  ID: ${this.caseData.case_id}?`,"warning",!0,"No",!0,"Yes, Proceed",!0,this.removeCase.bind(this))}clickCreateCase(){this.isReadOnly||this.form.disabled||this.form.invalid||this.alertService.confirmAlert("Are you sure?",`Do you want to create this case with Case ID: ${this.form.value.case_id}`,"warning",!0,"No",!0,"Yes, Proceed",!1,this.submit.bind(this))}submit(){this.form.invalid?console.error("Form is invalid"):(this.fullPageLoaderService.setLoadingStatus(!0),this.apiService.createNewCase({case_id:this.form.value.case_id,description:this.form.value.description}).subscribe({next:i=>{const s={id:i.data.id};console.log("Case creation successful:",i),this.alertService.successAlert("center","Case creation success","",3e3),this.router.navigate(["/document-managemnt/single-case"],{queryParams:s})},error:i=>{this.fullPageLoaderService.setLoadingStatus(!1),console.error("Registration failed:",i),this.alertService.errorAlert("center","Case creation failed",i.error.errorCode===p.C.ALREADY_EXIST||i.error.errorCode===p.C.ACCESSDENIED?i.error.message:"",3e3,!1,"",!1)},complete:()=>{this.fullPageLoaderService.setLoadingStatus(!1),console.log("Case creation request completed.")}}))}removeCase(){!this.form.invalid||this.isCaseCreation||this.isReadOnly?(this.fullPageLoaderService.setLoadingStatus(!0),this.apiService.removeCase(this.caseId).subscribe({next:t=>{console.log("Case deleation successful:",t),this.alertService.successAlert("center","Case removed successfully","",3e3),this.router.navigate(["/document-managemnt/document-upload"])},error:t=>{this.fullPageLoaderService.setLoadingStatus(!1),console.error("Registration failed:",t),this.alertService.errorAlert("center","Failed to remove the Case",t.error.errorCode===p.C.NOT_FOUND||t.error.errorCode===p.C.ACCESSDENIED?t.error.message:"",3e3,!1,"",!1)},complete:()=>{this.fullPageLoaderService.setLoadingStatus(!1),console.log("Case creation request completed.")}})):console.error("Form is invalid")}removeDocument(){this.isCaseCreation||this.isReadOnly?(this.fullPageLoaderService.setLoadingStatus(!0),this.apiService.removeDocumentCasecade(this.caseId).subscribe({next:t=>{console.log("Document deleation successful:",t),this.alertService.successAlert("center","Document removed successfully","",3e3)},error:t=>{this.fullPageLoaderService.setLoadingStatus(!1),console.error("Document delete failed:",t),this.alertService.errorAlert("center","Failed to remove the Document",t.error.errorCode===p.C.NOT_FOUND||t.error.errorCode===p.C.ACCESSDENIED?t.error.message:"",3e3,!1,"",!1)},complete:()=>{this.fullPageLoaderService.setLoadingStatus(!1),console.log("Document deletion request completed.")}})):console.error("invalid for delete doc")}enableDesableFrom(t){t?this.form.disable():this.form.enable()}loadCaseData(){if(!this.caseId)return this.isLoading=!0,this.isCaseCreation=!0,void console.error("User Id is invalid");this.isReadOnly=!y.q.hasCommonEditPermission(this.authService),this.isCaseCreation=!1,this.fullPageLoaderService.setLoadingStatus(!0),this.apiService.getOneCase(this.caseId).subscribe({next:t=>{console.log("Case fetching successful:",t),this.caseData=t.data,this.form.patchValue(this.caseData),this.isReadOnly&&this.form.disable(),this.documentTableData=this.caseData.documents,this.loadDocumentTableData(),console.log("this.caseData"),console.log(this.caseData),console.log("this.caseData"),this.isLoading=!1},error:t=>{this.enableDesableFrom(!0),this.fullPageLoaderService.setLoadingStatus(!1),console.error("Case loading failed:",t),t.error.errorCode===p.C.NOT_FOUND?this.alertService.errorAlert("center","Case not found",t.error.message,3e3,!1,"",!1):t.error.errorCode===p.C.ACCESSDENIED?this.alertService.errorAlert("center","You are not permitted to load this case",t.error.message,4e3,!1,"",!1):this.alertService.errorAlert("center","Error while loading case details","",3e3,!1,"",!1),this.router.navigate(["/document-managemnt/document-upload"])},complete:()=>{this.fullPageLoaderService.setLoadingStatus(!1),console.log("Case loading request completed.")}})}loadDocumentTableData(){this.dataSource=new l.I6(this.documentTableData),this.dataSource.paginator=this.paginator}clickBack(){this.location.back()}static#e=this.\u0275fac=function(i){return new(i||a)(e.rXU(u.aZ),e.rXU(v.Ix),e.rXU(v.nX),e.rXU(G.I),e.rXU(I),e.rXU(L.u),e.rXU(N.J))};static#t=this.\u0275cmp=e.VBU({type:a,selectors:[["app-single-case-table-pagination"]],viewQuery:function(i,s){if(1&i&&e.GBs(R.iy,5),2&i){let n;e.mGM(n=e.lsd())&&(s.paginator=n.first)}},inputs:{currentUserOrGroup:[1,"currentUserOrGroup"]},outputs:{currentUserOrGroup:"currentUserOrGroupChange"},standalone:!0,features:[e.Jv_([I,L.u,{provide:A.$T,useValue:{expandedHeight:"48px",collapsedHeight:"48px",animationDuration:"225ms cubic-bezier(0.4,0.0,0.2,1)"}}]),e.aNF],decls:10,vars:6,consts:[[1,"container"],[3,"change","ngModelChange","ngModel"],["class","row",4,"ngIf"],["class","row justify-content-start",4,"ngIf"],[1,"row"],[1,"col"],["class","m-r-8","mat-flat-button","","color","warn",4,"ngIf"],[1,"b-1","shadow-none"],[3,"formGroup"],[1,"mat-subtitle-2","f-s-14","f-w-600","m-b-2","d-block"],["style","color: black; vertical-align: middle; margin-bottom: 3px;","name","lock","class","icon-22",4,"ngIf"],["appearance","outline","color","primary",1,"w-100","m-b-0"],["formControlName","case_id","matInput","","placeholder","","value","CASE_NOV_102",3,"disabled"],[4,"ngIf"],["formControlName","description","matInput","","value","Test Description about case",3,"disabled"],["align","end",4,"ngIf"],["name","lock",1,"icon-22",2,"color","black","vertical-align","middle","margin-bottom","3px"],["align","end"],["type","button","mat-stroked-button","","color","warn",1,"m-r-10",3,"click"],[2,"font-size","1.4rem"],["type","button","mat-flat-button","","color","primary",1,"m-r-8",3,"click","disabled"],[1,"row","justify-content-start"],["mat-button","",3,"click"],[3,"backToCaseDetails","caseId"],["class","col",4,"ngIf"],[1,"document-card","b-1","shadow-none"],[1,"row","justify-content-between"],[1,"col","p-t-4"],[1,"mat-subtitle-1","f-s-18","f-w-600"],["class","col-sm-6 col-md-6 col-lg-6 p-t-6",4,"ngIf"],[1,"col-sm-6","col-md-6","col-lg-6","p-t-6"],["class","download-mat-spinner","mat-stroked-button","",3,"disabled",4,"ngIf"],["class","col-left",4,"ngIf"],["class","table-responsive",4,"ngIf"],["showFirstLastButtons","","aria-label","Select page of periodic elements",3,"pageSizeOptions"],["mat-stroked-button","",3,"click","disabled"],["aria-hidden","false",2,"color","#4456e9"],["mat-stroked-button","",3,"click","ngClass","disabled"],["aria-hidden","false",2,"color","#24db0e"],["mat-stroked-button","",1,"download-mat-spinner",3,"disabled"],["color","accent","diameter","20"],[1,"col-left"],["appearance","outline","color","primary",1,"w-50","m-b-0"],["matInput","","placeholder","Filter",3,"keyup"],[1,"table-responsive"],[1,"justify-content-between"],[1,"col","align-items-start","d-flex","align-items-center","gap-2"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","document_name"],["mat-cell","","class","mat-body-1",4,"matCellDef"],["matColumnDef","action"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],[3,"change","checked","indeterminate","aria-label"],["mat-cell",""],[3,"click","change","checked","aria-label"],["mat-cell","",1,"mat-body-1"],[1,"d-flex","align-items-center"],["name","file-type-pdf",1,"icon-20",2,"color","rgb(190, 8, 8)","font-weight","bold"],[1,"d-flex","flex-column"],[2,"font-size","12px","color","gray","line-height","1"],[1,"d-flex","justify-content-center","gap-4"],["class","cursor-pointer",4,"ngIf"],[1,"cursor-pointer"],["name","edit",1,"icon-22"],["name","trash",1,"icon-22",2,"color","red",3,"click"],["name","download",1,"icon-22",2,"color","rgb(16, 152, 6)","font-weight","bold"],["mat-row",""],["mat-flat-button","","color","warn",1,"m-r-8"],[3,"expanded"],[2,"justify-content","center"],["class","m-r-8","mat-flat-button","","color","warn",3,"disabled","click",4,"ngIf"],["mat-flat-button","","color","warn",1,"m-r-8",3,"click","disabled"]],template:function(i,s){1&i&&(e.j41(0,"div",0)(1,"p")(2,"mat-slide-toggle",1),e.bIt("change",function(){return s.onToggleChange()}),e.mxI("ngModelChange",function(d){return e.DH7(s.isAdmin,d)||(s.isAdmin=d),d}),e.EFF(3),e.k0s()(),e.DNE(4,bt,23,10,"div",2)(5,St,5,1,"div",3)(6,Gt,2,1,"div",2),e.j41(7,"div",4)(8,"div",5),e.DNE(9,Nt,9,2,"mat-accordion",6),e.k0s()()()),2&i&&(e.R7$(2),e.R50("ngModel",s.isAdmin),e.R7$(),e.SpI("",s.isAdmin?"Admin View":"User View"," (Note: Only for testing purpose)"),e.R7$(),e.Y8G("ngIf",!s.isUpload),e.R7$(),e.Y8G("ngIf",s.isUpload&&s.isAdmin),e.R7$(),e.Y8G("ngIf",!s.isUpload),e.R7$(3),e.Y8G("ngIf",!s.isCaseCreation&&s.isAdmin&&!s.isUpload))},dependencies:[l.tP,l.Zl,l.tL,l.cC,l.YV,l.iL,l.KS,l.$R,l.NB,u.MD,u.YU,u.bT,c.YN,c.qT,c.me,c.BC,c.cb,c.vS,F.RG,F.rl,F.nJ,F.TL,c.X1,c.j4,c.JD,m.Hu,m.RN,m.YY,m.m2,m.MM,B.G,M.So,O.fg,E.sG,A.BS,A.GK,A.Z2,A.WN,A.Q6,S.$z,T.An,H.LG,R.iy,T.m_,X.Cn,S.Hl,E.mV,D.X4,D.Jc,z.Ph,v.iI,J.Wk,M.g7,te.YN,V.jL,dt,H.D6,W.y,A.MY],styles:[".mat-column-select[_ngcontent-%COMP%]{padding-right:0!important}.document-card[_ngcontent-%COMP%]   .mat-mdc-card-header[_ngcontent-%COMP%]{display:inline-block}.download-mat-spinner[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{width:18px!important;height:18px!important}mat-accordion[_ngcontent-%COMP%]{display:flex;justify-content:end}mat-panel-title[_ngcontent-%COMP%]{color:#f14d7c!important}mat-panel-description[_ngcontent-%COMP%]{justify-content:center}mat-expansion-panel-header[_ngcontent-%COMP%]   .mat-expansion-indicator[_ngcontent-%COMP%]{visibility:hidden!important}.highlight-download[_ngcontent-%COMP%]{border-color:#4ef327}"]})}return a})(),Mt=(()=>{class a{static#e=this.\u0275fac=function(i){return new(i||a)};static#t=this.\u0275cmp=e.VBU({type:a,selectors:[["app-single-case-details"]],standalone:!0,features:[e.aNF],decls:1,vars:0,template:function(i,s){1&i&&e.nrm(0,"app-single-case-table-pagination")},dependencies:[Ot]})}return a})();var ae=r(2014);const Vt=[{path:"",children:[{path:"document-upload",component:Fe,canActivate:[ae.K],data:{title:"Available Cases",expectedRole:g.N.ADMIN}},{path:"document-access",component:He,canActivate:[ae.K],data:{title:"Manage Document Access",expectedRole:g.N.ADMIN}},{path:"single-case",component:Mt,data:{title:"Case Detail"}}]}]}}]);