"use strict";(self.webpackChunkdocument_management_system_lw_frontend=self.webpackChunkdocument_management_system_lw_frontend||[]).push([[251],{1251:(Ot,J,r)=>{r.r(J),r.d(J,{DocumentManagemntRoutes:()=>Nt});var h=r(177),g=r(5596),c=r(9159),Y=r(7722),R=r(9213),B=r(9115),w=r(8834),A=r(6695),y=r(450),D=r(4912),X=r(2529),C=r(2168),ie=r(6633),E=r(1626),e=r(3953),se=r(7843);let T=(()=>{class i{constructor(t){this.apiService=t}getOneCase(t){return this.apiService.get(`/cases/find/${t}`)}getAllCases(t){return this.apiService.get(`/cases/?case_id=${t}`)}getAllCasesWithServerSidePagination(t,a,s,n){const d=(new E.Nl).set("page",t.toString()).set("limit",a.toString()).set("sortBy",s).set("order",n);return this.apiService.get("/cases",d)}getAllowedUsersByDocId(t){return this.apiService.get(`/documents/${t}/users`)}createNewCase(t,a){return this.apiService.post("/cases",t,a)}updateCase(t,a,s){return this.apiService.put(`/cases/${a}`,t,s)}removeCase(t){return this.apiService.delete(`/cases/${t}`)}fileBatchUpload(t,a){const s={headers:new E.Lr({Accept:"application/json"}),reportProgress:!0,observe:"events"};return this.apiService.post(`/documents/batch-upload/${t}`,a,s)}fileBatchDownload(t,a){return this.apiService.post("/documents/batch-download/",{case_id:t,fileKeys:a},{responseType:"blob"})}singleFileDownload(t,a){return this.apiService.post("/documents/single-download",{case_id:t,fileUrl:a},{responseType:"blob"})}static#e=this.\u0275fac=function(a){return new(a||i)(e.KVO(se.Z))};static#t=this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac})}return i})();var ne=r(2042),H=r(9172),K=r(5558),Q=r(6354),j=r(9437),z=r(7224),l=r(5505),oe=r(8149),x=r(7418),P=r(4006),G=r(9088),U=r(4535),I=r(2102),N=r(9631);const re=()=>[5,10,25,100];function le(i,o){if(1&i){const t=e.RV6();e.j41(0,"mat-form-field",11)(1,"input",12),e.bIt("keyup",function(s){e.eBV(t);const n=e.XpG();return e.Njj(n.applyFilter(s))}),e.k0s()()}}function ce(i,o){1&i&&e.nrm(0,"app-content-loader",13),2&i&&e.Y8G("loaderType","button")}function de(i,o){1&i&&(e.j41(0,"button",14),e.nrm(1,"i-tabler",15),e.k0s()),2&i&&e.Y8G("routerLink","/document-managemnt/single-case")}function me(i,o){1&i&&(e.j41(0,"th",27),e.EFF(1," Case ID "),e.k0s())}function ue(i,o){if(1&i&&(e.j41(0,"td",28)(1,"div",29)(2,"div",30)(3,"h6",31),e.EFF(4),e.k0s()()()()),2&i){const t=o.$implicit;e.R7$(4),e.SpI(" ",t.case_id," ")}}function pe(i,o){1&i&&(e.j41(0,"th",27),e.EFF(1," Documents "),e.k0s())}function ge(i,o){if(1&i&&(e.j41(0,"td",32),e.nrm(1,"i-tabler",33),e.EFF(2),e.k0s()),2&i){const t=o.$implicit;e.R7$(2),e.SpI(" ",t.documents.length," ")}}function fe(i,o){1&i&&(e.j41(0,"th",27),e.EFF(1," Last Updated Date "),e.k0s())}function he(i,o){if(1&i&&(e.j41(0,"td",34),e.EFF(1),e.nI1(2,"date"),e.k0s()),2&i){const t=o.$implicit;e.R7$(),e.SpI(" ",e.i5U(2,1,t.updatedAt,"dd MMM yyyy, HH:mm:ss")," ")}}function _e(i,o){1&i&&(e.j41(0,"th",27),e.EFF(1,"Action"),e.k0s())}function Ce(i,o){if(1&i){const t=e.RV6();e.j41(0,"td",28)(1,"a",35),e.nrm(2,"i-tabler",36),e.k0s(),e.j41(3,"a",35)(4,"i-tabler",37),e.bIt("click",function(){const s=e.eBV(t).$implicit,n=e.XpG(2);return e.Njj(n.openDialog("100ms","100ms",s))}),e.k0s()()()}if(2&i){const t=e.XpG(2);e.R7$(2),e.Y8G("routerLink",t.editRouterLink)}}function be(i,o){1&i&&e.nrm(0,"tr",38)}function ve(i,o){if(1&i){const t=e.RV6();e.j41(0,"tr",39),e.bIt("click",function(){const s=e.eBV(t).$implicit,n=e.XpG(2);return e.Njj(n.navigateSingleCase(s))}),e.k0s()}}function Se(i,o){if(1&i&&(e.j41(0,"table",16),e.qex(1,17),e.DNE(2,me,2,0,"th",18)(3,ue,5,1,"td",19),e.bVm(),e.qex(4,20),e.DNE(5,pe,2,0,"th",18)(6,ge,3,1,"td",21),e.bVm(),e.qex(7,22),e.DNE(8,fe,2,0,"th",18)(9,he,3,4,"td",23),e.bVm(),e.qex(10,24),e.DNE(11,_e,2,0,"th",18)(12,Ce,5,1,"td",19),e.bVm(),e.DNE(13,be,1,0,"tr",25)(14,ve,1,0,"tr",26),e.k0s()),2&i){const t=e.XpG();e.Y8G("dataSource",t.dataSource),e.R7$(13),e.Y8G("matHeaderRowDef",t.displayedColumns),e.R7$(),e.Y8G("matRowDefColumns",t.displayedColumns)}}function De(i,o){1&i&&e.nrm(0,"app-content-loader",40),2&i&&e.Y8G("loaderType","table")}function Te(i,o){1&i&&e.nrm(0,"app-content-loader",13),2&i&&e.Y8G("loaderType","paginator")}let Ie=(()=>{class i{constructor(t,a,s,n,d,u,f){this.router=t,this.activatedRoute=a,this.apiService=s,this.alertService=n,this.deleteConfirmDialog=d,this.authService=u,this.fullPageLoaderService=f,this.tableData=[],this.displayedColumns=["id","documents","last_updated","action"],this.removeDialogTitle="Do you want to remove?",this.messageBodayKey="",this.editRouterLink="",this.resultsLength=0,this.isLoadingResults=!0,this.isLoading=!0,this.isRateLimitReached=!1,this.pageSize=5,this.isAdmin=!1,this.caseId="",this.dataSource=new c.I6}ngOnInit(){this.isAdmin=this.authService.hasRole(l.N.ADMIN)}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.sort&&(this.dataSource.sort=this.sort),this.paginator.page.pipe((0,H.Z)({}),(0,K.n)(()=>(this.isLoadingResults=!0,this.requestTableData(this.sort?this.sort.active:"case_id",this.sort?this.sort.direction:"asc")))).subscribe(t=>{this.isLoadingResults=!1,this.tableData=t,this.dataSource=new c.I6(this.tableData)})}isBackDisabled(){return 0===this.paginator.pageIndex}isNextDisabled(){return this.paginator.pageIndex===Math.ceil(this.resultsLength/this.paginator.pageSize)-1}requestTableData(t,a){return this.apiService.getAllCasesWithServerSidePagination(this.paginator.pageIndex,this.paginator.pageSize,t,a).pipe((0,Q.T)(s=>(this.resultsLength=s.total,s.data)),(0,j.W)(()=>(this.isLoadingResults=!1,this.isRateLimitReached=!0,[])))}onPageChange(){this.isLoadingResults=!0,this.requestTableData(this.sort?this.sort.active:"case_id",this.sort?this.sort.direction:"asc").subscribe(s=>{this.isLoadingResults=!1,this.resultsLength=s.total,this.dataSource.data=s.data})}applyFilter(t){this.dataSource.filter=t.target.value.trim().toLowerCase()}openDialog(t,a,s){this.deleteConfirmDialog.open(ie.P,{width:"30%",enterAnimationDuration:t,exitAnimationDuration:a,data:{item:s[this.messageBodayKey],title:this.removeDialogTitle}})}navigateSingleCase(t){console.log(t),this.router.navigate(["/document-managemnt/single-case"],{queryParams:{id:t.id}})}static#e=this.\u0275fac=function(a){return new(a||i)(e.rXU(C.Ix),e.rXU(C.nX),e.rXU(T),e.rXU(x.I),e.rXU(P.bZ),e.rXU(G.u),e.rXU(U.J))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["app-case-table-pagination"]],viewQuery:function(a,s){if(1&a&&(e.GBs(ne.B4,5),e.GBs(A.iy,5)),2&a){let n;e.mGM(n=e.lsd())&&(s.sort=n.first),e.mGM(n=e.lsd())&&(s.paginator=n.first)}},standalone:!0,features:[e.Jv_([T,h.vh]),e.aNF],decls:13,vars:12,consts:[[1,"cardWithShadow"],[1,"row","justify-content-between","m-l-4","m-r-4"],[1,"col-left"],["appearance","outline","class","w-100 m-b-0","color","primary",4,"ngIf"],[1,"col-right","m-r-30","m-t-2"],[3,"loaderType",4,"ngIf"],["color","primary","mat-stroked-button","",3,"routerLink",4,"ngIf"],[1,"table-responsive"],["mat-table","","class","w-100",3,"dataSource",4,"ngIf"],["style","padding-top: 2px !important;",3,"loaderType",4,"ngIf"],[3,"page","length","pageSize","pageSizeOptions"],["appearance","outline","color","primary",1,"w-100","m-b-0"],["matInput","","placeholder","Filter",3,"keyup"],[3,"loaderType"],["color","primary","mat-stroked-button","",3,"routerLink"],["name","users-plus",1,"icon-22",2,"color","blue"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","class","f-w-600 mat-subtitle-1 f-s-14",4,"matHeaderCellDef"],["mat-cell","","class","mat-body-1",4,"matCellDef"],["matColumnDef","documents"],["mat-cell","",4,"matCellDef"],["matColumnDef","last_updated"],["mat-cell","","class","mat-body-1 f-s-12 f-w-600",4,"matCellDef"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",1,"f-w-600","mat-subtitle-1","f-s-14"],["mat-cell","",1,"mat-body-1"],[1,"d-flex","align-items-center"],[1,"m-l-16"],[1,"mat-body-1","f-s-12","f-w-600"],["mat-cell",""],["name","file-type-pdf",1,"icon-22"],["mat-cell","",1,"mat-body-1","f-s-12","f-w-600"],[1,"m-r-10","cursor-pointer"],["name","edit",1,"icon-22",3,"routerLink"],["name","trash",1,"icon-22","outline-red",3,"click"],["mat-header-row",""],["mat-row","",3,"click"],[2,"padding-top","2px !important",3,"loaderType"]],template:function(a,s){1&a&&(e.j41(0,"mat-card",0)(1,"mat-card-content")(2,"div",1)(3,"div",2),e.DNE(4,le,2,0,"mat-form-field",3),e.k0s(),e.j41(5,"div",4),e.DNE(6,ce,1,1,"app-content-loader",5)(7,de,2,1,"button",6),e.k0s()(),e.j41(8,"div",7),e.DNE(9,Se,15,3,"table",8)(10,De,1,1,"app-content-loader",9)(11,Te,1,1,"app-content-loader",5),e.k0s(),e.j41(12,"mat-paginator",10),e.bIt("page",function(){return s.onPageChange()}),e.k0s()()()),2&a&&(e.R7$(4),e.Y8G("ngIf",!s.isLoadingResults),e.R7$(2),e.Y8G("ngIf",s.isLoadingResults),e.R7$(),e.Y8G("ngIf",!s.isLoadingResults),e.R7$(2),e.Y8G("ngIf",!s.isLoadingResults),e.R7$(),e.Y8G("ngIf",s.isLoadingResults),e.R7$(),e.Y8G("ngIf",s.isLoadingResults),e.R7$(),e.xc7("visibility",s.isLoadingResults?"hidden":"visible"),e.Y8G("length",s.resultsLength)("pageSize",s.pageSize)("pageSizeOptions",e.lJ4(11,re)))},dependencies:[c.tP,c.Zl,c.tL,c.ji,c.cC,c.YV,c.iL,c.KS,c.$R,c.YZ,c.NB,h.MD,h.bT,h.vh,g.Hu,g.RN,g.m2,Y.G,I.rl,N.fg,w.$z,A.iy,R.m_,B.Cn,w.Hl,y.mV,D.X4,D.Jc,X.Ph,C.iI,C.Wk,z.y,oe.G],styles:[".mat-mdc-row[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]{border-bottom:1px solid transparent;border-top:1px solid transparent;cursor:pointer}.mat-mdc-row[_ngcontent-%COMP%]:hover   .mat-mdc-cell[_ngcontent-%COMP%]{border-color:#43cdf7!important}"]})}return i})(),Fe=(()=>{class i{static#e=this.\u0275fac=function(a){return new(a||i)};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["app-document-upload"]],standalone:!0,features:[e.aNF],decls:1,vars:0,template:function(a,s){1&a&&e.nrm(0,"app-case-table-pagination")},dependencies:[Ie],encapsulation:2})}return i})();var m=r(9417),O=r(5951),Z=r(5024),k=r(2765),q=r(8617),L=r(850),ee=r(6471),M=r(7336),Re=r(771),we=r(2798),Ae=r(152),Pe=r(1985);let ke=(()=>{class i{transform(t,a){if(!t||!a)return t;const s=a.toLowerCase();return t.filter(n=>n.name.toLowerCase().includes(s)||n.email.toLowerCase().includes(s)||n.role.toLowerCase().includes(s))}static#e=this.\u0275fac=function(a){return new(a||i)};static#t=this.\u0275pipe=e.EJ8({name:"userFilter",type:i,pure:!0,standalone:!0})}return i})();var $=r(5478);Array.from({length:25},(i,o)=>{const t=(o+1).toString();return{user_id:t,name:`Allowed User ${t}`,email:`alloweduser${t}@example.com`,role:o%2==0?l.N.ADMIN:l.N.USER,status:l.z.ACTIVE,created_date:"2024-10-27",profile_image:"",mobileNumber:`+94712390${String(100+o).slice(-3)}`}});const ye=Array.from({length:100},(i,o)=>{const t=(o+1).toString();return{user_id:t,name:`Non-Allowed User ${t}`,email:`nonalloweduser${t}@example.com`,role:o%2==0?l.N.ADMIN:l.N.USER,status:l.z.DEACTIVE,created_date:"2024-10-27",profile_image:`assets/images/profile/user-${o%8+1}.jpg`,mobileNumber:`+94712390${String(100+o+25).slice(-3)}`}});Array.from({length:30},(i,o)=>{const t=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],a=t[Math.floor(Math.random()*t.length)],s=Math.floor(16*Math.random())+2010,n=Math.floor(11*Math.random()),d=Array.from({length:n},(u,f)=>({document_id:`DOC_CASE_${s}_${String(o+1).padStart(2,"0")}_${String(f+1).padStart(2,"0")}`,document_name:`Case Document ${f+1}.pdf`,file_size:Math.floor(10*Math.random())+1,created_date:`${s}-10-27`,updatedAt:`${s}-12-15`,description:"Test description",file_url:`https://example.com/documents/case-${o+1}-${f+1}.pdf`}));return{id:Math.floor(11*Math.random()).toString(),case_id:`CASE_${s}_${a}_${o+1}`,name:`Case ${o+1}`,allowed_users:Math.floor(100*Math.random())+1,documents:d,created_date:`${s}-10-27`,updatedAt:`${s}-12-15`,description:"Test description"}});var V=r(356),_=r(2155),v=function(i){return i.NEW="NEW",i.REMOVED="REMOVED",i.CURRENT="CURRENT",i}(v||{});let Ee=(()=>{class i{transform(t,a,s){return t&&0!=a.size?t.filter(n=>s?a.has(n.user_id+"")&&a.get(n.user_id+"")!==v.REMOVED:!a.has(n.user_id+"")||a.get(n.user_id+"")===v.REMOVED):t}static#e=this.\u0275fac=function(a){return new(a||i)};static#t=this.\u0275pipe=e.EJ8({name:"userFilterByAccessStatus",type:i,pure:!1,standalone:!0})}return i})();class je{static getRandomColor(){let t="#";for(let a=0;a<6;a++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t}}var xe=r(6600),S=r(3902);const Ge=()=>[5,10,20],te=()=>({standalone:!0});function Ue(i,o){if(1&i&&(e.j41(0,"mat-option",8),e.EFF(1),e.k0s()),2&i){const t=o.$implicit;e.Y8G("value",t),e.R7$(),e.JRh(t.case_id)}}function Ne(i,o){1&i&&(e.j41(0,"th",41),e.EFF(1," Select "),e.k0s())}function Oe(i,o){if(1&i){const t=e.RV6();e.j41(0,"td",42)(1,"mat-radio-group",43),e.mxI("ngModelChange",function(s){e.eBV(t);const n=e.XpG();return e.DH7(n.selectedRow,s)||(n.selectedRow=s),e.Njj(s)}),e.bIt("change",function(s){const n=e.eBV(t).$implicit,d=e.XpG();return e.Njj(d.onRowSelectionChange(s,n))}),e.nrm(2,"mat-radio-button",44),e.k0s()()}if(2&i){const t=o.$implicit,a=e.XpG();e.R7$(),e.Y8G("ngModelOptions",e.lJ4(4,te)),e.R50("ngModel",a.selectedRow),e.R7$(),e.Y8G("value",t)("aria-label","Select "+t.document_name)}}function Le(i,o){if(1&i&&(e.j41(0,"td",45)(1,"div",46),e.nrm(2,"i-tabler",47),e.j41(3,"div",48)(4,"div"),e.EFF(5),e.k0s(),e.j41(6,"div",49),e.EFF(7),e.k0s()(),e.j41(8,"a",21),e.nrm(9,"i-tabler",50),e.k0s()()()),2&i){const t=o.$implicit;e.R7$(5),e.JRh(t.document_name),e.R7$(2),e.SpI("",t.file_size,"MB")}}function Me(i,o){1&i&&(e.j41(0,"td",45)(1,"div",51)(2,"a",21),e.nrm(3,"i-tabler",52),e.k0s(),e.j41(4,"a",21),e.nrm(5,"i-tabler",53),e.k0s()()())}function $e(i,o){1&i&&e.nrm(0,"tr",54)}function Ve(i,o){if(1&i){const t=e.RV6();e.j41(0,"mat-list-item",55)(1,"div",56)(2,"app-user-thumbnail",57),e.bIt("clickActionIcon",function(s){e.eBV(t);const n=e.XpG();return e.Njj(n.removeAccessWarn(s))}),e.k0s()()()}if(2&i){const t=o.$implicit;e.R7$(2),e.Y8G("item",t)("hasActionIcon",!0)("iconName","circle-minus")("iconColor","rgb(219, 10, 59)")}}function Ye(i,o){if(1&i){const t=e.RV6();e.j41(0,"mat-list-item")(1,"div",56)(2,"app-user-thumbnail",57),e.bIt("clickActionIcon",function(s){e.eBV(t);const n=e.XpG();return e.Njj(n.giveAccessWarn(s))}),e.k0s()()()}if(2&i){const t=o.$implicit;e.R7$(2),e.Y8G("item",t)("hasActionIcon",!0)("iconName","circle-plus")("iconColor","rgb(10, 17, 219)")}}let Be=(()=>{class i{constructor(t,a,s,n,d){this.router=t,this.alertService=a,this.authService=s,this.fullPageLoaderService=n,this.apiService=d,this.caseId="",this.isReadOnly=!0,this.isLoading=!0,this.myControl=new m.MJ(""),this.isAdmin=!0,this.tableData=[],this.selectData=[],this.userTableDataAllowed=[],this.userTableDataNotAllowed=[],this.filterText="",this.displayedColumns=["select","name","action"],this.selection=new Z.CB(!0,[]),this.dataSource=new c.I6,this.removeDialogTitle="Do you want to remove?",this.messageBodayKey="",this.editRouterLink="",this.caseName="CASE_2012_SPE_15_1",this.caseDescription="Test description",this.isUpload=!1,this.updatedUserIdMap=new Map,this.userCurrentMap=new Map,this.deleteConfirmDialog=(0,e.WQX)(P.bZ),this.documentUploadDialog=(0,e.WQX)(P.bZ),this.separatorKeysCodes=[M.Fm,M.KE],this.currentUserOrGroup=(0,e.geq)(""),this.usersOrGroups=(0,e.vPA)([]),this.allUsersOrGroups=(0,e.vPA)([{name:"Dilupa",id:"100WS",isGroup:!1,profile_image:"assets/images/profile/user-1.jpg",email:"test@gmail.com",user:{user_id:"1",name:"Dilupa Marasinghe",email:"test@gmail.com",role:l.N.ADMIN,status:l.z.ACTIVE,created_date:"202-10-27",profile_image:"assets/images/profile/user-1.jpg"}},{name:"CASE November 1 -23",id:"CASE_441_NOV",isGroup:!0,profile_image:"assets/images/profile/user-1.jpg",email:"test@gmail.com",user:null},{name:"CASE Jan 3 -23",id:"CASE_201_NOV",isGroup:!0,profile_image:"assets/images/profile/user-1.jpg",email:"test@gmail.com",user:null},{name:"Randima",id:"102RANWS",isGroup:!1,profile_image:"assets/images/profile/user-1.jpg",email:"test@gmail.com",user:{user_id:"3",name:"Randima Senanayake",email:"test@gmail.com",role:l.N.USER,status:l.z.ACTIVE,created_date:"202-10-27",profile_image:"assets/images/profile/user-3.jpg"}},{name:"CASE Mrch 3 -12",id:"CASE_011_NOV",isGroup:!0,profile_image:"assets/images/profile/user-1.jpg",email:"test@gmail.com",user:null},{name:"Kasun",id:"100KSWS",isGroup:!1,profile_image:"assets/images/profile/user-1.jpg",email:"test@gmail.com",user:{user_id:"5",name:"K.S.C.Janith",email:"test@gmail.com",role:l.N.USER,status:l.z.DEACTIVE,created_date:"202-10-27",profile_image:"assets/images/profile/user-5.jpg"}}]),this.filteredUsersOrGroups=(0,e.EWP)(()=>{const u=this.currentUserOrGroup().toLowerCase(),f=new Set(this.usersOrGroups().map(p=>p.id));return this.allUsersOrGroups().filter(p=>!f.has(p.id)).filter(p=>p.name.toLowerCase().includes(u))}),this.announcer=(0,e.WQX)(q.Ai),this.filteredFruits=(0,e.EWP)(()=>{const u=this.currentUserOrGroup().toLowerCase(),f=new Set(this.usersOrGroups().map(p=>p.id));return this.allUsersOrGroups().filter(p=>!f.has(p.id)).filter(p=>p.name.toLowerCase().includes(u))})}ngAfterViewInit(){this.dataSource.paginator=this.paginator}trackByUserId(t,a){return a.user_id}ngOnInit(){this.userTableDataNotAllowed=ye,this.userTableDataNotAllowed.map(t=>t.profile_image=je.getRandomColor()),this.dataSource=new c.I6(this.tableData),this.filteredOptions=this.myControl.valueChanges.pipe((0,H.Z)(""),(0,Ae.B)(300),(0,K.n)(t=>this.searchCases(t)))}searchCases(t){return!t||t.length<2?new Pe.c(a=>{a.next([]),a.complete()}):this.apiService.getAllCases(t).pipe((0,Q.T)(a=>a.data))}loadAllCaseData(){if(!this.caseId)return this.isLoading=!0,void console.error("User Id is invalid");this.isReadOnly=!V.q.hasCommonEditPermission(this.authService),this.fullPageLoaderService.setLoadingStatus(!0),this.apiService.getOneCase(this.caseId).subscribe({next:t=>{console.log("Case fetching successful:",t),this.caseData=t.data,this.tableData=this.caseData.documents,this.loadDocumentTableData(),console.log("this.caseData"),console.log(this.caseData),console.log("this.caseData"),this.isLoading=!1},error:t=>{this.fullPageLoaderService.setLoadingStatus(!1),console.error("Case loading failed:",t),t.error.errorCode===_.C.NOT_FOUND?this.alertService.errorAlert("center","Case not found",t.error.message,3e3,!1,"",!1):t.error.errorCode===_.C.ACCESSDENIED?this.alertService.errorAlert("center","You are not permitted to load this case",t.error.message,4e3,!1,"",!1):this.alertService.errorAlert("center","Error while loading case details","",3e3,!1,"",!1),this.router.navigate(["/document-managemnt/document-upload"])},complete:()=>{this.fullPageLoaderService.setLoadingStatus(!1),console.log("Case loading request completed.")}})}loadCaseData(){if(!this.caseId)return this.isLoading=!0,void console.error("User Id is invalid");this.isReadOnly=!V.q.hasCommonEditPermission(this.authService),this.fullPageLoaderService.setLoadingStatus(!0),this.apiService.getOneCase(this.caseId).subscribe({next:t=>{console.log("Case fetching successful:",t),this.caseData=t.data,this.tableData=this.caseData.documents,this.loadDocumentTableData(),console.log("this.caseData"),console.log(this.caseData),console.log("this.caseData"),this.isLoading=!1},error:t=>{this.fullPageLoaderService.setLoadingStatus(!1),console.error("Case loading failed:",t),t.error.errorCode===_.C.NOT_FOUND?this.alertService.errorAlert("center","Case not found",t.error.message,3e3,!1,"",!1):t.error.errorCode===_.C.ACCESSDENIED?this.alertService.errorAlert("center","You are not permitted to load this case",t.error.message,4e3,!1,"",!1):this.alertService.errorAlert("center","Error while loading case details","",3e3,!1,"",!1),this.router.navigate(["/document-managemnt/document-upload"])},complete:()=>{this.fullPageLoaderService.setLoadingStatus(!1),console.log("Case loading request completed.")}})}loadAllowedUsers(t){if(!t)return this.isLoading=!0,void console.error("Document Id is invalid");this.isReadOnly=!V.q.hasCommonEditPermission(this.authService),this.fullPageLoaderService.setLoadingStatus(!0),this.apiService.getAllowedUsersByDocId(t).subscribe({next:a=>{console.log("Document access details fetching successful:",a),this.userTableDataAllowed=a.data,this.userTableDataAllowed.forEach(s=>{this.updatedUserIdMap.set(s.user_id.toString(),v.CURRENT),this.userCurrentMap.set(s.user_id,s)}),console.log("documentId"),console.log(t),console.log("documentId"),this.isLoading=!1},error:a=>{this.fullPageLoaderService.setLoadingStatus(!1),console.error("Document access details loading failed:",a),a.error.errorCode===_.C.NOT_FOUND?this.alertService.errorAlert("center","Document ID not found",a.error.message,3e3,!1,"",!1):a.error.errorCode===_.C.ACCESSDENIED?this.alertService.errorAlert("center","You are not permitted to use document access details",a.error.message,4e3,!1,"",!1):this.alertService.errorAlert("center","Error while document access details","",3e3,!1,"",!1),this.updatedUserIdMap=new Map,this.userCurrentMap=new Map,this.router.navigate(["/document-managemnt/document-upload"])},complete:()=>{this.fullPageLoaderService.setLoadingStatus(!1),console.log("Document access details loading request completed.")}})}loadDocumentTableData(){this.dataSource=new c.I6(this.tableData),this.dataSource.paginator=this.paginator}onRowSelectionChange(t,a){console.log("Selected Row:",a),this.loadAllowedUsers(a.document_id)}onOptionSelected(t){console.log(t.option.value),this.selectedCase=t.option.value,this.caseId=this.selectedCase.id,this.loadCaseData()}onToggleChange(){}backToCase(){this.isUpload=!1}removeAccessWarn(t){console.log(t),this.alertService.confirmAlert("Are you sure?",`Removing access for this user: ${t.name}`,"warning",!0,"No",!0,"Yes, Proceed",!1,this.removeUserFromAllowedList.bind(this,t))}giveAccessWarn(t){console.log(t),this.alertService.confirmAlert("Are you sure?",`Enabling access for this user: ${t.name}`,"warning",!0,"No",!0,"Yes, Proceed",!1,this.addUserToAllowedMap.bind(this,t))}addUserToAllowedMap(t){this.updatedUserIdMap.has(t.user_id)&&this.updatedUserIdMap.get(t.user_id)===v.CURRENT||(this.userCurrentMap.has(t.user_id)&&this.updatedUserIdMap.set(t.user_id,v.CURRENT),this.updatedUserIdMap.has(t.user_id)||this.updatedUserIdMap.set(t.user_id,v.NEW))}removeUserFromAllowedList(t){!this.updatedUserIdMap.has(t.user_id)||this.updatedUserIdMap.get(t.user_id)===v.REMOVED||this.updatedUserIdMap.has(t.user_id)&&this.updatedUserIdMap.set(t.user_id,v.REMOVED)}isAllSelected(){return this.selection.selected.length===this.dataSource.data.length}toggleAllRows(){this.isAllSelected()?this.selection.clear():this.selection.select(...this.dataSource.data)}checkboxLabel(t){return t?`${this.selection.isSelected(t)?"deselect":"select"} row ${t.document_id}`:(this.isAllSelected()?"Deselect":"Select")+" all"}applyFilter(t){this.dataSource.filter=t.target.value.trim().toLowerCase()}add(t){const a=(t.value||"").trim();if(a){const s=this.allUsersOrGroups().find(n=>n.name.toLowerCase()===a.toLowerCase());s&&this.usersOrGroups.update(n=>[...n,s])}this.currentUserOrGroup.set("")}remove(t){this.usersOrGroups.update(a=>{const s=a.findIndex(n=>n.id===t.id);return s<0?a:(a.splice(s,1),this.announcer.announce(`Removed ${t.name}`),[...a])}),this.allUsersOrGroups.update(a=>[...a,t]),this.updateFilteredData()}updateFilteredData(){this.filteredUsersOrGroups()}handleBackspace(){if(!this.currentUserOrGroup()){const t=this.usersOrGroups();t.length>0&&this.remove(t[t.length-1])}}selected(t){const a=this.allUsersOrGroups().find(s=>s.name===t.option.value.name);a&&(this.usersOrGroups.update(s=>[...s,a]),this.allUsersOrGroups.update(s=>s.filter(n=>n.id!==a.id))),this.currentUserOrGroup.set("")}openFileUploadDialog(){this.isUpload=!0}_filter(t){const a=t.toLowerCase();return this.selectData.filter(s=>s.case_id.toLowerCase().includes(a))}displayFn(t){return t&&t.case_id?t.case_id:""}static#e=this.\u0275fac=function(a){return new(a||i)(e.rXU(C.Ix),e.rXU(x.I),e.rXU(G.u),e.rXU(U.J),e.rXU(T))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["app-document-access-table-pagination"]],viewQuery:function(a,s){if(1&a&&e.GBs(A.iy,5),2&a){let n;e.mGM(n=e.lsd())&&(s.paginator=n.first)}},inputs:{currentUserOrGroup:[1,"currentUserOrGroup"]},outputs:{currentUserOrGroup:"currentUserOrGroupChange"},standalone:!0,features:[e.Jv_([T]),e.aNF],decls:77,vars:44,consts:[["auto","matAutocomplete"],[1,"b-1","shadow-none"],[1,"row"],[1,"col-md-6"],[1,"mat-subtitle-2","f-s-14","f-w-600"],["appearance","outline","color","primary",1,"w-100","m-b-0","m-t-2"],["matInput","",3,"formControl","matAutocomplete"],[3,"optionSelected","displayWith"],[3,"value"],[1,"document-card","b-1","shadow-none"],[1,"row","justify-content-between"],[1,"col","p-t-4"],[1,"mat-subtitle-1","f-s-18","f-w-600"],[1,"col-left","col-md-4"],["appearance","outline","color","primary",1,"w-100","m-b-0"],["matInput","","placeholder","Filter",3,"keyup"],[1,"table-responsive"],[1,"justify-content-between"],[1,"col","align-items-start"],[3,"change","checked","indeterminate","aria-label"],[1,"col","align-items-start","d-flex","align-items-center","gap-2"],[1,"cursor-pointer"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-cell","","class","mat-body-1",4,"matCellDef"],["matColumnDef","action"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","Select page of periodic elements",3,"pageSizeOptions"],[1,"col-left","m-b-6"],["appearance","outline","color","primary",1,"w-100","m-b-0",2,"margin-top","-0.06rem !important"],["matInput","","placeholder","Filter",3,"ngModelChange","ngModelOptions","ngModel"],[1,"m-t-8","m-b-0"],["itemSize","10",1,"virtual-scroll-container"],["class","mat-list-item-hover",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],[4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],["align","end"],["mat-flat-button","","color","primary",1,"m-r-8"],["routerLink","/document-managemnt/document-upload","mat-stroked-button","","color","warn"],["mat-header-cell",""],["mat-cell",""],[3,"ngModelChange","change","ngModelOptions","ngModel"],[3,"value","aria-label"],["mat-cell","",1,"mat-body-1"],[1,"d-flex","align-items-center"],["name","file-type-pdf",1,"icon-20",2,"color","rgb(190, 8, 8)","font-weight","bold"],[1,"d-flex","flex-column"],[2,"font-size","12px","color","gray","line-height","1"],["name","download",1,"icon-22",2,"color","rgb(16, 152, 6)","font-weight","bold"],[1,"d-flex","justify-content-center","gap-4"],["name","edit",1,"icon-22"],["name","trash",1,"icon-22",2,"color","red"],["mat-row",""],[1,"mat-list-item-hover"],[1,"row","justify-content-between","m-l-4","m-r-4"],[3,"clickActionIcon","item","hasActionIcon","iconName","iconColor"]],template:function(a,s){if(1&a){const n=e.RV6();e.j41(0,"mat-card",1)(1,"mat-card-content")(2,"form")(3,"div",2)(4,"div",3)(5,"mat-label",4),e.EFF(6,"Select Case ID"),e.k0s(),e.j41(7,"mat-form-field",5),e.nrm(8,"input",6),e.j41(9,"mat-autocomplete",7,0),e.bIt("optionSelected",function(u){return e.eBV(n),e.Njj(s.onOptionSelected(u))}),e.Z7z(11,Ue,2,2,"mat-option",8,e.fX1),e.nI1(13,"async"),e.k0s()()()(),e.j41(14,"mat-card",9)(15,"mat-card-header")(16,"div",10)(17,"div",11)(18,"mat-label",12),e.EFF(19),e.k0s()()()(),e.j41(20,"mat-card-content")(21,"div",13)(22,"mat-form-field",14)(23,"input",15),e.bIt("keyup",function(u){return e.eBV(n),e.Njj(s.applyFilter(u))}),e.k0s()()(),e.j41(24,"div",16)(25,"div",17)(26,"div",2)(27,"div",18)(28,"mat-checkbox",19),e.bIt("change",function(u){return e.eBV(n),e.Njj(u?s.toggleAllRows():null)}),e.k0s(),e.EFF(29),e.k0s(),e.j41(30,"div",20),e.nrm(31,"span",21),e.k0s()()(),e.j41(32,"table",22),e.qex(33,23),e.DNE(34,Ne,2,0,"th",24)(35,Oe,3,5,"td",25),e.bVm(),e.qex(36,26),e.DNE(37,Le,10,2,"td",27),e.bVm(),e.qex(38,28),e.DNE(39,Me,6,0,"td",27),e.bVm(),e.DNE(40,$e,1,0,"tr",29),e.k0s()(),e.nrm(41,"mat-paginator",30),e.k0s()(),e.j41(42,"div",2)(43,"div",3)(44,"div",31)(45,"mat-form-field",32)(46,"input",33),e.mxI("ngModelChange",function(u){return e.eBV(n),e.DH7(s.filterText,u)||(s.filterText=u),e.Njj(u)}),e.k0s()()()()(),e.j41(47,"div",2)(48,"div",3)(49,"mat-card",1)(50,"mat-card-header")(51,"mat-card-title",34),e.EFF(52),e.nI1(53,"userFilterByAccessStatus"),e.nI1(54,"userFilter"),e.k0s()(),e.j41(55,"mat-card-content")(56,"cdk-virtual-scroll-viewport",35)(57,"mat-list"),e.DNE(58,Ve,3,4,"mat-list-item",36),e.nI1(59,"userFilterByAccessStatus"),e.nI1(60,"userFilter"),e.k0s()()()()(),e.j41(61,"div",3)(62,"mat-card",1)(63,"mat-card-header")(64,"mat-card-title",34),e.EFF(65),e.k0s()(),e.j41(66,"mat-card-content")(67,"cdk-virtual-scroll-viewport",35)(68,"mat-list"),e.DNE(69,Ye,3,4,"mat-list-item",37),e.nI1(70,"userFilterByAccessStatus"),e.nI1(71,"userFilter"),e.k0s()()()()()(),e.j41(72,"mat-card-actions",38)(73,"button",39),e.EFF(74,"Save This"),e.k0s(),e.j41(75,"button",40),e.EFF(76,"Cancel"),e.k0s()()()()()}if(2&a){const n=e.sdS(10);e.R7$(8),e.Y8G("formControl",s.myControl)("matAutocomplete",n),e.R7$(),e.Y8G("displayWith",s.displayFn),e.R7$(2),e.Dyx(e.bMT(13,19,s.filteredOptions)),e.R7$(8),e.SpI(" Documents (",s.tableData.length,") "),e.R7$(9),e.Y8G("checked",s.selection.hasValue()&&s.isAllSelected())("indeterminate",s.selection.hasValue()&&!s.isAllSelected())("aria-label",s.checkboxLabel()),e.R7$(),e.SpI(" ",s.checkboxLabel()," "),e.R7$(3),e.Y8G("dataSource",s.dataSource),e.R7$(8),e.Y8G("matRowDefColumns",s.displayedColumns),e.R7$(),e.Y8G("pageSizeOptions",e.lJ4(42,Ge)),e.R7$(5),e.Y8G("ngModelOptions",e.lJ4(43,te)),e.R50("ngModel",s.filterText),e.R7$(6),e.SpI("Allowed Members (",e.i5U(54,25,e.brH(53,21,s.userTableDataNotAllowed,s.updatedUserIdMap,!0),s.filterText).length,") "),e.R7$(6),e.Y8G("cdkVirtualForOf",e.i5U(60,32,e.brH(59,28,s.userTableDataNotAllowed,s.updatedUserIdMap,!0),s.filterText))("cdkVirtualForTrackBy",s.trackByUserId),e.R7$(7),e.SpI("Not Allowed Members (",s.userTableDataNotAllowed.length,")"),e.R7$(4),e.Y8G("cdkVirtualForOf",e.i5U(71,39,e.brH(70,35,s.userTableDataNotAllowed,s.updatedUserIdMap,!1),s.filterText))("cdkVirtualForTrackBy",s.trackByUserId)}},dependencies:[c.tP,c.Zl,c.tL,c.cC,c.YV,c.iL,c.KS,c.$R,c.NB,h.MD,h.Jj,m.YN,m.qT,m.me,m.BC,m.cb,m.vS,m.cV,g.Hu,g.RN,g.YY,g.m2,g.MM,g.dh,Y.G,L.$3,xe.wT,L.pN,k.So,I.rl,I.nJ,N.fg,O.VT,O._g,S.jt,S.YE,w.$z,A.iy,R.m_,B.Cn,w.Hl,y.mV,D.X4,D.Jc,X.Ph,C.iI,C.Wk,O.Wk,k.g7,ee.YN,L.jL,Re.D,N.fS,we.Ve,m.X1,m.l_,ke,Ee,$.E9,$.yg,$.E$,$.d6,z.y],styles:[".mat-column-select[_ngcontent-%COMP%]{padding-right:0!important}.document-card[_ngcontent-%COMP%]   .mat-mdc-card-header[_ngcontent-%COMP%]{display:inline-block}.virtual-scroll-container[_ngcontent-%COMP%]{height:300px;width:100%;overflow:auto}mat-list-item[_ngcontent-%COMP%]:hover{background:#e5f5ff}"]})}return i})(),Xe=(()=>{class i{static#e=this.\u0275fac=function(a){return new(a||i)};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["app-document-access"]],standalone:!0,features:[e.aNF],decls:1,vars:0,template:function(a,s){1&a&&e.nrm(0,"app-document-access-table-pagination")},dependencies:[Be],encapsulation:2})}return i})();var ze=r(7575),W=r(9183),We=r(4412);let Je=(()=>{class i{constructor(){this.uploadProgressSubject=new We.t(0),this.uploadProgress$=this.uploadProgressSubject.asObservable()}uploadFiles(t,a,s){const n=new FormData;return a.forEach(d=>{n.append("files",d,d.name)}),s.fileBatchUpload(t,n).pipe((0,j.W)(d=>{throw console.error("Error during file upload:",d),d}))}static#e=this.\u0275fac=function(a){return new(a||i)};static#t=this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var He=r(1997);function Ke(i,o){if(1&i){const t=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"div",7),e.bIt("drop",function(s){e.eBV(t);const n=e.XpG();return e.Njj(n.onDrop(s))})("dragover",function(s){return e.eBV(t),e.Njj(s.preventDefault())})("click",function(){e.eBV(t);const s=e.sdS(8);return e.Njj(s.click())}),e.j41(3,"mat-icon",8),e.EFF(4,"cloud_upload"),e.k0s(),e.j41(5,"span"),e.EFF(6,"Drag and drop here or click to upload"),e.k0s(),e.j41(7,"input",9,0),e.bIt("change",function(s){e.eBV(t);const n=e.XpG();return e.Njj(n.onFileInputChange(s))}),e.k0s()()()()}}function Qe(i,o){if(1&i){const t=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"div",10),e.nrm(3,"mat-spinner"),e.j41(4,"span"),e.EFF(5,"Uploading in progress..."),e.k0s(),e.j41(6,"input",9,0),e.bIt("change",function(s){e.eBV(t);const n=e.XpG();return e.Njj(n.onFileInputChange(s))}),e.k0s()()()()}}function Ze(i,o){if(1&i){const t=e.RV6();e.j41(0,"div",24),e.bIt("click",function(){e.eBV(t);const s=e.XpG().index,n=e.XpG(2);return e.Njj(n.removeFile(s))}),e.j41(1,"mat-icon",25),e.EFF(2,"clear"),e.k0s()()}}function qe(i,o){1&i&&(e.j41(0,"div",26)(1,"mat-icon"),e.nrm(2,"mat-spinner",27),e.k0s()())}function et(i,o){1&i&&(e.j41(0,"div",28)(1,"mat-icon",29),e.EFF(2,"cloud_done"),e.k0s()())}function tt(i,o){if(1&i&&(e.j41(0,"mat-list-item")(1,"div",3)(2,"div",16)(3,"mat-icon",17),e.EFF(4,"description"),e.k0s()(),e.j41(5,"div",18)(6,"div",19),e.EFF(7),e.k0s(),e.j41(8,"div",20),e.EFF(9),e.nI1(10,"date"),e.k0s()(),e.DNE(11,Ze,3,0,"div",21)(12,qe,3,0,"div",22)(13,et,3,0,"div",23),e.k0s()()),2&i){const t=o.$implicit,a=e.XpG(2);e.R7$(7),e.JRh(t.name),e.R7$(2),e.JRh(e.bMT(10,5,t.lastModified)),e.R7$(2),e.Y8G("ngIf",!a.progressStarted),e.R7$(),e.Y8G("ngIf",a.progressStarted),e.R7$(),e.Y8G("ngIf",!1)}}function at(i,o){if(1&i&&(e.j41(0,"div",11)(1,"div",12),e.EFF(2,"CASE_2024_NOV-21 "),e.j41(3,"span",13),e.EFF(4),e.k0s()(),e.nrm(5,"mat-divider"),e.j41(6,"mat-list",14),e.DNE(7,tt,14,7,"mat-list-item",15),e.k0s()()),2&i){const t=e.XpG();e.R7$(4),e.SpI("(",t.files.length," Selected)"),e.R7$(2),e.Y8G("disabled",t.progressStarted),e.R7$(),e.Y8G("ngForOf",t.files)}}function it(i,o){if(1&i){const t=e.RV6();e.j41(0,"button",32),e.bIt("click",function(){e.eBV(t);const s=e.XpG(2);return e.Njj(s.startProgressUpload())}),e.EFF(1,"Start Upload"),e.k0s()}}function st(i,o){1&i&&(e.j41(0,"button",33),e.EFF(1,"Disabled"),e.k0s())}function nt(i,o){if(1&i&&(e.qex(0),e.DNE(1,it,2,0,"button",30)(2,st,2,0,"button",31),e.bVm()),2&i){const t=e.XpG();e.R7$(),e.Y8G("ngIf",!t.progressStarted),e.R7$(),e.Y8G("ngIf",t.progressStarted)}}let ot=(()=>{class i{constructor(t,a,s,n,d){this.router=t,this.fileUploadService=a,this.componentApiService=s,this.alertService=n,this.fullPageLoaderService=d,this.caseId="",this.backToCaseDetails=new e.bkB,this.progressStarted=!1,this.files=[],this.progress=0}ngOnInit(){}onDrop(t){t.preventDefault();const a=t.dataTransfer?.files;a&&this.addFiles(a)}onFileInputChange(t){const a=t.target;a&&a.files&&this.addFiles(a.files)}addFiles(t){for(let a=0;a<t.length;a++)this.files.push(t[a])}startUpload(){}uploadFiles(){this.files.length>0?(this.fullPageLoaderService.setLoadingStatus(!0),this.fileUploadService.uploadFiles(this.caseId,Array.from(this.files),this.componentApiService).subscribe({next:t=>{if(t.type===E.hv.Response){const a={id:this.caseId};this.fullPageLoaderService.setLoadingStatus(!1),console.log("Upload successful:",t.body?.message),this.alertService.successAlert("center","File upload success","",3e3,!0,!0,!0),this.router.navigate(["/document-managemnt/single-case"],{queryParams:a}),this.backToCaseDetails.emit(!0)}},error:t=>{this.fullPageLoaderService.setLoadingStatus(!1),console.error("Upload failed:",t),this.alertService.errorAlert("center","Faill to upload files","",3e3,!1,"",!1)},complete:()=>{this.fullPageLoaderService.setLoadingStatus(!1),this.progressStarted=!1}})):console.error("No files selected")}removeFile(t){this.files.splice(t,1)}startProgressUpload(){this.progressStarted=!0,this.uploadFiles()}getProgress(t){}static#e=this.\u0275fac=function(a){return new(a||i)(e.rXU(C.Ix),e.rXU(Je),e.rXU(T),e.rXU(x.I),e.rXU(U.J))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["app-file-upload-ui"]],inputs:{caseId:"caseId"},outputs:{backToCaseDetails:"backToCaseDetails"},standalone:!0,features:[e.aNF],decls:9,vars:4,consts:[["fileInput",""],[1,"container"],["class","row",4,"ngIf"],[1,"row"],[1,"col"],["class","files-list-section mb-4 w-100",4,"ngIf"],[4,"ngIf"],[1,"upload-area",3,"drop","dragover","click"],[1,"upload-icon","mb-2",2,"font-size","48px"],["type","file","multiple","","hidden","",3,"change"],[1,"upload-area","upload-area-desabled"],[1,"files-list-section","mb-4","w-100"],["mat-subheader",""],[2,"font-size","small"],[1,"file-list",3,"disabled"],[4,"ngFor","ngForOf"],[1,"col-md-1","col-sm-1"],["matListItemIcon",""],[1,"col-md-9"],["matListItemTitle",""],["matListItemLine",""],["class","col-md-2",3,"click",4,"ngIf"],["style","padding-top: 15px;","class","col-md-2",4,"ngIf"],["class","col-md-2",4,"ngIf"],[1,"col-md-2",3,"click"],["matListItemIcon","",1,"cursor-pointer"],[1,"col-md-2",2,"padding-top","15px"],["color","accent","diameter","20"],[1,"col-md-2"],["matListItemIcon","",2,"color","rgb(4, 207, 7)"],["mat-raised-button","","color","primary","class","mt-3 w-100",3,"click",4,"ngIf"],["mat-stroked-button","","disabled","",4,"ngIf"],["mat-raised-button","","color","primary",1,"mt-3","w-100",3,"click"],["mat-stroked-button","","disabled",""]],template:function(a,s){1&a&&(e.j41(0,"div",1),e.DNE(1,Ke,9,0,"div",2)(2,Qe,8,0,"div",2),e.j41(3,"div",3)(4,"div",4),e.DNE(5,at,8,3,"div",5),e.k0s()(),e.j41(6,"div",3)(7,"div",4),e.DNE(8,nt,3,2,"ng-container",6),e.k0s()()()),2&a&&(e.R7$(),e.Y8G("ngIf",!s.progressStarted),e.R7$(),e.Y8G("ngIf",s.progressStarted),e.R7$(3),e.Y8G("ngIf",s.files.length>0),e.R7$(3),e.Y8G("ngIf",s.files.length>0))},dependencies:[h.MD,h.Sq,h.bT,h.vh,R.m_,R.An,P.hM,ze.PO,k.g7,S.Fg,S.jt,S.YE,S.ZV,S.EI,He.q,S.C_,S.yE,D.X4,W.LG],styles:[".container[_ngcontent-%COMP%]{width:50vw;max-width:100%;padding:0;margin:0;box-sizing:border-box}h1.mat-dialog-title[_ngcontent-%COMP%]{font-size:24px;color:#2196f3;text-align:center;margin-bottom:20px}.description[_ngcontent-%COMP%]{font-size:16px;text-align:center;margin-bottom:30px;color:#424242}.upload-area-desabled[_ngcontent-%COMP%]{border:2px dashed #4e5052!important;background-color:#ebf2f7!important}.upload-area[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;padding:50px;background-color:#f1f8ff;border-radius:8px;border:2px dashed #2196f3;cursor:pointer;transition:border-color .3s ease;text-align:center;min-height:300px;width:100%;box-sizing:border-box}.upload-area[_ngcontent-%COMP%]:hover{border-color:#1976d2}.upload-area[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:60px;color:#1976d2;margin-bottom:10px}.upload-area[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px;color:#424242}.row[_ngcontent-%COMP%], .col[_ngcontent-%COMP%]{width:100%;max-width:100%;margin:0;padding:0;box-sizing:border-box}.file-list[_ngcontent-%COMP%]{flex-direction:column;margin-bottom:20px;overflow-y:auto;max-height:300px;width:100%}.file-list[_ngcontent-%COMP%]   .mdc-list-item__primary-text[_ngcontent-%COMP%]{font-size:small}.file-list[_ngcontent-%COMP%]   .mdc-list-item__secondary-text[_ngcontent-%COMP%]{font-size:smaller}.files-list-section[_ngcontent-%COMP%]{display:ruby}button[mat-raised-button][_ngcontent-%COMP%]{padding:12px 24px;font-size:16px;background-color:#2196f3;color:#fff;border-radius:8px;margin-top:20px;width:100%;transition:background-color .3s ease;border:none}button[mat-raised-button][_ngcontent-%COMP%]:hover{background-color:#1976d2}button[mat-stroked-button][_ngcontent-%COMP%]{padding:12px 24px;font-size:16px;background-color:#2092ec54!important;border-radius:8px;margin-top:20px;width:100%;transition:background-color .3s ease;border:none}@media (max-width: 600px){mat-dialog-content[_ngcontent-%COMP%]{padding:10px;min-width:100%}.upload-area[_ngcontent-%COMP%]{padding:20px;min-height:250px}.upload-area[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:10px;color:#424242}.file-list[_ngcontent-%COMP%]{max-height:250px}.file-list-item[_ngcontent-%COMP%]{font-size:12px;padding:8px}.file-card[_ngcontent-%COMP%]{padding:12px;flex-direction:column;align-items:flex-start}.file-list-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px}.file-list-item[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%], span[_ngcontent-%COMP%]{font-size:16px}button[mat-raised-button][_ngcontent-%COMP%]{padding:10px 20px;font-size:14px}}@media (min-width: 601px){.upload-area[_ngcontent-%COMP%]{padding:40px;min-height:280px}}@media (min-width: 769px){mat-dialog-content[_ngcontent-%COMP%]{padding:20px;min-width:500px;min-height:360px}.upload-area[_ngcontent-%COMP%]{padding:40px;min-height:180px}.file-card[_ngcontent-%COMP%]{padding:15px}button[mat-raised-button][_ngcontent-%COMP%]{padding:12px 24px;font-size:16px}.upload-icon[_ngcontent-%COMP%]{font-size:100px!important;display:contents!important}}"]})}return i})();var F=r(9454);const rt=()=>[5,10,20];function lt(i,o){1&i&&e.nrm(0,"i-tabler",16)}function ct(i,o){1&i&&(e.j41(0,"mat-error"),e.EFF(1," Case ID is required. "),e.k0s())}function dt(i,o){1&i&&(e.j41(0,"mat-error"),e.EFF(1," Case ID must be at least 3 characters long. "),e.k0s())}function mt(i,o){1&i&&(e.j41(0,"mat-error"),e.EFF(1," Case ID cannot exceed 50 characters. "),e.k0s())}function ut(i,o){1&i&&e.nrm(0,"i-tabler",16)}function pt(i,o){1&i&&(e.j41(0,"mat-error"),e.EFF(1," Name cannot exceed 300 characters. "),e.k0s())}function gt(i,o){if(1&i){const t=e.RV6();e.j41(0,"mat-card-actions",17)(1,"button",18),e.bIt("click",function(){e.eBV(t);const s=e.XpG(2);return e.Njj(s.clickBack())}),e.j41(2,"mat-icon",19),e.EFF(3,"arrow_back"),e.k0s(),e.EFF(4," Back"),e.k0s(),e.j41(5,"button",20),e.bIt("click",function(){e.eBV(t);const s=e.XpG(2);return e.Njj(s.clickCreateCase())}),e.EFF(6,"Save This"),e.k0s()()}if(2&i){const t=e.XpG(2);e.R7$(5),e.Y8G("disabled",t.form.invalid||t.isReadOnly)}}function ft(i,o){if(1&i&&(e.j41(0,"div",4)(1,"div",5)(2,"mat-card",7)(3,"mat-card-content")(4,"form",8)(5,"div",4)(6,"div",5)(7,"mat-label",9),e.DNE(8,lt,1,0,"i-tabler",10),e.EFF(9," Case ID "),e.k0s(),e.j41(10,"mat-form-field",11),e.nrm(11,"input",12),e.DNE(12,ct,2,0,"mat-error",13)(13,dt,2,0,"mat-error",13)(14,mt,2,0,"mat-error",13),e.k0s()(),e.j41(15,"div",5)(16,"mat-label",9),e.DNE(17,ut,1,0,"i-tabler",10),e.EFF(18," Description"),e.k0s(),e.j41(19,"mat-form-field",11),e.nrm(20,"textarea",14),e.DNE(21,pt,2,0,"mat-error",13),e.k0s()()(),e.DNE(22,gt,7,1,"mat-card-actions",15),e.k0s()()()()()),2&i){const t=e.XpG();e.R7$(4),e.Y8G("formGroup",t.form),e.R7$(4),e.Y8G("ngIf",!t.isAdmin),e.R7$(3),e.Y8G("disabled",!t.isAdmin),e.R7$(),e.Y8G("ngIf",t.f.case_id.hasError("required")&&(t.f.case_id.touched||t.f.case_id.dirty)),e.R7$(),e.Y8G("ngIf",t.f.case_id.hasError("minlength")&&(t.f.case_id.touched||t.f.case_id.dirty)),e.R7$(),e.Y8G("ngIf",t.f.case_id.hasError("maxlength")&&(t.f.case_id.touched||t.f.case_id.dirty)),e.R7$(3),e.Y8G("ngIf",!t.isAdmin),e.R7$(3),e.Y8G("disabled",!t.isAdmin),e.R7$(),e.Y8G("ngIf",t.f.description.hasError("maxlength")&&(t.f.description.touched||t.f.description.dirty)),e.R7$(),e.Y8G("ngIf",t.isAdmin)}}function ht(i,o){if(1&i){const t=e.RV6();e.j41(0,"div",21)(1,"button",22),e.bIt("click",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.backToCase())}),e.j41(2,"mat-icon",19),e.EFF(3,"arrow_back"),e.k0s()(),e.j41(4,"app-file-upload-ui",23),e.bIt("backToCaseDetails",function(s){e.eBV(t);const n=e.XpG();return e.Njj(n.handleBackToCaseDetailsEvent(s))}),e.k0s()()}if(2&i){const t=e.XpG();e.R7$(4),e.Y8G("caseId",t.caseId)}}function _t(i,o){if(1&i){const t=e.RV6();e.j41(0,"div",30)(1,"button",36),e.bIt("click",function(){e.eBV(t);const s=e.XpG(3);return e.Njj(s.openFileUploadDialog())}),e.j41(2,"mat-icon",37),e.EFF(3,"upload_file"),e.k0s(),e.EFF(4," Upload Files "),e.k0s()()}if(2&i){const t=e.XpG(3);e.R7$(),e.Y8G("disabled",t.enableDownloadSelected||t.isReadOnly)}}function Ct(i,o){if(1&i){const t=e.RV6();e.j41(0,"button",36),e.bIt("click",function(){e.eBV(t);const s=e.XpG(3);return e.Njj(s.downloadConfirm())}),e.j41(1,"mat-icon",38),e.EFF(2,"download_file"),e.k0s(),e.EFF(3," Download Files "),e.k0s()}if(2&i){const t=e.XpG(3);e.Y8G("disabled",!(t.selection.hasValue()&&t.selection.selected.length<=5))}}function bt(i,o){1&i&&(e.j41(0,"button",39)(1,"mat-icon"),e.nrm(2,"mat-spinner",40),e.k0s(),e.EFF(3," Download Files "),e.k0s()),2&i&&e.Y8G("disabled",!0)}function vt(i,o){if(1&i){const t=e.RV6();e.j41(0,"div",41)(1,"mat-form-field",42)(2,"input",43),e.bIt("keyup",function(s){e.eBV(t);const n=e.XpG(3);return e.Njj(n.applyFilter(s))}),e.k0s()()()}}function St(i,o){if(1&i){const t=e.RV6();e.j41(0,"th",55)(1,"mat-checkbox",56),e.bIt("change",function(s){e.eBV(t);const n=e.XpG(4);return e.Njj(s?n.toggleAllRows():null)}),e.k0s()()}if(2&i){const t=e.XpG(4);e.R7$(),e.Y8G("checked",t.selection.hasValue()&&t.isAllSelected())("indeterminate",t.selection.hasValue()&&!t.isAllSelected())("aria-label",t.checkboxLabel())}}function Dt(i,o){if(1&i){const t=e.RV6();e.j41(0,"td",57)(1,"mat-checkbox",58),e.bIt("click",function(s){return e.eBV(t),e.Njj(s.stopPropagation())})("change",function(s){const n=e.eBV(t).$implicit,d=e.XpG(4);return e.Njj(s?d.selection.toggle(n):null)}),e.k0s()()}if(2&i){const t=o.$implicit,a=e.XpG(4);e.R7$(),e.Y8G("checked",a.selection.isSelected(t))("aria-label",a.checkboxLabel(t))}}function Tt(i,o){if(1&i){const t=e.RV6();e.j41(0,"a",65),e.bIt("click",function(){e.eBV(t);const s=e.XpG().$implicit,n=e.XpG(4);return e.Njj(n.downloadConfirmForIconClick(s.file_url,s.document_name))}),e.nrm(1,"i-tabler",66),e.k0s()}}function It(i,o){if(1&i&&(e.j41(0,"td",59)(1,"div",60),e.nrm(2,"i-tabler",61),e.j41(3,"div",62)(4,"div"),e.EFF(5),e.k0s(),e.j41(6,"div",63),e.EFF(7),e.k0s()(),e.DNE(8,Tt,2,0,"a",64),e.k0s()()),2&i){const t=o.$implicit,a=e.XpG(4);e.R7$(5),e.JRh(t.document_name),e.R7$(2),e.SpI("",t.file_size,"MB"),e.R7$(),e.Y8G("ngIf",a.isAdmin)}}function Ft(i,o){1&i&&(e.j41(0,"a",69),e.nrm(1,"i-tabler",70),e.k0s())}function Rt(i,o){1&i&&(e.j41(0,"a",69),e.nrm(1,"i-tabler",71),e.k0s())}function wt(i,o){1&i&&(e.j41(0,"a",69),e.nrm(1,"i-tabler",66),e.k0s())}function At(i,o){if(1&i&&(e.j41(0,"td",59)(1,"div",67),e.DNE(2,Ft,2,0,"a",68)(3,Rt,2,0,"a",68)(4,wt,2,0,"a",68),e.k0s()()),2&i){const t=e.XpG(4);e.R7$(2),e.Y8G("ngIf",t.isAdmin),e.R7$(),e.Y8G("ngIf",t.isAdmin),e.R7$(),e.Y8G("ngIf",!t.isAdmin)}}function Pt(i,o){1&i&&e.nrm(0,"tr",72)}function kt(i,o){if(1&i&&(e.j41(0,"div",44)(1,"div",45)(2,"div",4),e.nrm(3,"div",46),e.k0s()(),e.j41(4,"table",47),e.qex(5,48),e.DNE(6,St,2,3,"th",49)(7,Dt,2,2,"td",50),e.bVm(),e.qex(8,51),e.DNE(9,It,9,3,"td",52),e.bVm(),e.qex(10,53),e.DNE(11,At,5,3,"td",52),e.bVm(),e.DNE(12,Pt,1,0,"tr",54),e.k0s()()),2&i){const t=e.XpG(3);e.R7$(4),e.Y8G("dataSource",t.dataSource),e.R7$(8),e.Y8G("matRowDefColumns",t.displayedColumns)}}function yt(i,o){if(1&i&&(e.j41(0,"div",5)(1,"mat-card",25)(2,"mat-card-header")(3,"div",26)(4,"div",27)(5,"mat-label",28),e.EFF(6),e.k0s()()(),e.j41(7,"div",26),e.DNE(8,_t,5,1,"div",29),e.j41(9,"div",30),e.DNE(10,Ct,4,1,"button",31)(11,bt,4,1,"button",32),e.k0s()()(),e.j41(12,"mat-card-content"),e.DNE(13,vt,3,0,"div",33)(14,kt,13,2,"div",34),e.nrm(15,"mat-paginator",35),e.k0s()()()),2&i){const t=e.XpG(2);e.R7$(6),e.SpI(" Documents (",t.documentTableData.length,") "),e.R7$(2),e.Y8G("ngIf",t.isAdmin),e.R7$(2),e.Y8G("ngIf",!t.enableDownloadSelected),e.R7$(),e.Y8G("ngIf",t.enableDownloadSelected),e.R7$(2),e.Y8G("ngIf",!t.isCaseCreation),e.R7$(),e.Y8G("ngIf",!t.isCaseCreation),e.R7$(),e.Y8G("pageSizeOptions",e.lJ4(7,rt))}}function Et(i,o){if(1&i&&(e.j41(0,"div",4),e.DNE(1,yt,16,8,"div",24),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Y8G("ngIf",!t.isCaseCreation)}}function jt(i,o){if(1&i){const t=e.RV6();e.j41(0,"button",77),e.bIt("click",function(){e.eBV(t);const s=e.XpG(2);return e.Njj(s.deleteConfirmation())}),e.EFF(1,"Delete"),e.k0s()}if(2&i){const t=e.XpG(2);e.Y8G("disabled",t.isReadOnly)}}function xt(i,o){if(1&i&&(e.j41(0,"mat-accordion",73)(1,"mat-expansion-panel",74)(2,"mat-expansion-panel-header")(3,"mat-panel-title"),e.EFF(4," Remove This Case "),e.j41(5,"mat-icon"),e.EFF(6,"delete"),e.k0s()()(),e.j41(7,"mat-panel-description",75),e.DNE(8,jt,2,1,"button",76),e.k0s()()()),2&i){const t=e.XpG();e.R7$(),e.Y8G("expanded",!1),e.R7$(7),e.Y8G("ngIf",!t.isCaseCreation)}}let Gt=(()=>{class i{constructor(t,a,s,n,d,u){this.router=t,this.activatedRoute=a,this.alertService=s,this.apiService=n,this.authService=d,this.fullPageLoaderService=u,this.isAdmin=!1,this.caseId="",this.isCaseCreation=!1,this.isReadOnly=!0,this.isLoading=!0,this.documentTableData=[],this.userTableData=[],this.displayedColumns=["select","document_name","action"],this.selection=new Z.CB(!0,[]),this.enableDownloadSelected=!1,this.dataSource=new c.I6,this.removeDialogTitle="Do you want to remove?",this.messageBodayKey="",this.editRouterLink="",this.caseName="CASE_2012_SPE_15_1",this.caseDescription="Test description",this.isUpload=!1,this.selectedFilesList=[],this.deleteConfirmDialog=(0,e.WQX)(P.bZ),this.documentUploadDialog=(0,e.WQX)(P.bZ),this.separatorKeysCodes=[M.Fm,M.KE],this.currentUserOrGroup=(0,e.geq)(""),this.usersOrGroups=(0,e.vPA)([]),this.allUsersOrGroups=(0,e.vPA)([{name:"Dilupa",id:"100WS",isGroup:!1,profile_image:"assets/images/profile/user-1.jpg",email:"test@gmail.com",user:{user_id:"1",name:"Dilupa Marasinghe",email:"test@gmail.com",role:l.N.ADMIN,status:l.z.ACTIVE,created_date:"202-10-27",profile_image:"assets/images/profile/user-1.jpg"}},{name:"CASE November 1 -23",id:"CASE_441_NOV",isGroup:!0,profile_image:"assets/images/profile/user-1.jpg",email:"test@gmail.com",user:null},{name:"CASE Jan 3 -23",id:"CASE_201_NOV",isGroup:!0,profile_image:"assets/images/profile/user-1.jpg",email:"test@gmail.com",user:null},{name:"Randima",id:"102RANWS",isGroup:!1,profile_image:"assets/images/profile/user-1.jpg",email:"test@gmail.com",user:{user_id:"3",name:"Randima Senanayake",email:"test@gmail.com",role:l.N.USER,status:l.z.ACTIVE,created_date:"202-10-27",profile_image:"assets/images/profile/user-3.jpg"}},{name:"CASE Mrch 3 -12",id:"CASE_011_NOV",isGroup:!0,profile_image:"assets/images/profile/user-1.jpg",email:"test@gmail.com",user:null},{name:"Kasun",id:"100KSWS",isGroup:!1,profile_image:"assets/images/profile/user-1.jpg",email:"test@gmail.com",user:{user_id:"5",name:"K.S.C.Janith",email:"test@gmail.com",role:l.N.USER,status:l.z.DEACTIVE,created_date:"202-10-27",profile_image:"assets/images/profile/user-5.jpg"}}]),this.filteredUsersOrGroups=(0,e.EWP)(()=>{const f=this.currentUserOrGroup().toLowerCase(),p=new Set(this.usersOrGroups().map(b=>b.id));return this.allUsersOrGroups().filter(b=>!p.has(b.id)).filter(b=>b.name.toLowerCase().includes(f))}),this.announcer=(0,e.WQX)(q.Ai),this.http=(0,e.WQX)(E.Qq),this.filteredFruits=(0,e.EWP)(()=>{const f=this.currentUserOrGroup().toLowerCase(),p=new Set(this.usersOrGroups().map(b=>b.id));return this.allUsersOrGroups().filter(b=>!p.has(b.id)).filter(b=>b.name.toLowerCase().includes(f))}),this.form=new m.gE({case_id:new m.MJ("",[m.k0.required,m.k0.minLength(3),m.k0.maxLength(50)]),description:new m.MJ("",[m.k0.maxLength(300)])})}get f(){return this.form.controls}ngAfterViewInit(){this.dataSource.paginator=this.paginator}ngOnInit(){this.isAdmin=this.authService.hasRole(l.N.ADMIN),this.enableDesableFrom(!this.isAdmin),this.isReadOnly=!this.isAdmin,this.activatedRoute.queryParams.subscribe(t=>{this.caseId=t.id,this.loadCaseData()}),this.userTableData=[{user_id:"1",name:"Dilupa Marasinghe",email:"test@gmail.com",role:l.N.ADMIN,status:l.z.ACTIVE,created_date:"202-10-27",profile_image:"assets/images/profile/user-1.jpg",mobileNumber:"+94712390348"},{user_id:"2",name:"Asith siriwardhana",email:"test@gmail.com",role:l.N.USER,status:l.z.ACTIVE,created_date:"202-10-27",profile_image:"assets/images/profile/user-2.jpg",mobileNumber:"+94712390348"},{user_id:"3",name:"Kasun janaka",email:"test@gmail.com",role:l.N.USER,status:l.z.ACTIVE,created_date:"202-10-27",profile_image:"assets/images/profile/user-3.jpg",mobileNumber:"+94712390348"},{user_id:"4",name:"Herath P.L.G",email:"test@gmail.com",role:l.N.USER,status:l.z.ACTIVE,created_date:"202-10-27",profile_image:"assets/images/profile/user-4.jpg",mobileNumber:"+94712390348"},{user_id:"5",name:"K.S.C.Janith",email:"test@gmail.com",role:l.N.USER,status:l.z.DEACTIVE,created_date:"202-10-27",profile_image:"assets/images/profile/user-5.jpg",mobileNumber:"+94712390348"},{user_id:"6",name:"Kamal Senath",email:"test@gmail.com",role:l.N.USER,status:l.z.ACTIVE,created_date:"202-10-27",profile_image:"assets/images/profile/user-6.jpg",mobileNumber:"+94712390348"},{user_id:"7",name:"Lal Guruge",email:"test@gmail.com",role:l.N.USER,status:l.z.ACTIVE,created_date:"202-10-27",profile_image:"assets/images/profile/user-7.jpg",mobileNumber:"+94712390348"},{user_id:"8",name:"Sahan H.L.R",email:"test@gmail.com",role:l.N.USER,status:l.z.ACTIVE,created_date:"202-10-27",profile_image:"assets/images/profile/user-8.jpg",mobileNumber:"+94712390348"}]}onToggleChange(){}backToCase(){this.isUpload=!1}handleBackToCaseDetailsEvent(t){t&&(this.isUpload=!1,this.loadCaseData())}isAllSelected(){return this.selection.selected.length===this.dataSource.data.length}toggleAllRows(){this.isAllSelected()?this.selection.clear():this.selection.select(...this.dataSource.data)}downloadConfirm(){if(this.selection.selected.length>0){const t=this.selection.selected.map(s=>s.document_name),a=this.generateHtmlList(t);this.alertService.confirmAlertWithHtml("Do you want to download below documents?",a,"warning",!0,"No",!0,"Yes, Proceed",!1,this.downloadSelected.bind(this))}}downloadConfirmForIconClick(t,a){if(t&&a){const n=this.generateHtmlList([a]);this.alertService.confirmAlertWithHtml("Do you want to download below documents?",n,"warning",!0,"No",!0,"Yes, Proceed",!1,this.sendSingleFileDownloadRequest.bind(this,t,a))}}generateHtmlList(t){return`<ul style="list-style-type: disclosure-closed;justify-content: center; display: grid;">\n    ${t.map(a=>`<li>${a}</li>`).join("")}\n  </ul>`}downloadSelected(){1===this.selection.selected.length?this.selection.selected[0].file_url&&this.sendSingleFileDownloadRequest(this.selection.selected[0].file_url,this.selection.selected[0].document_name):this.selection.selected.length>1?(console.log(this.selection.selected),this.sendBatchDownloadRequest()):this.alertService.errorToaster("top-end","Please select documents to download")}checkboxLabel(t){return t?`${this.selection.isSelected(t)?"deselect":"select"} row ${t.document_id}`:(this.isAllSelected()?"Deselect":"Select")+" all"}applyFilter(t){this.dataSource.filter=t.target.value.trim().toLowerCase()}add(t){const a=(t.value||"").trim();if(a){const s=this.allUsersOrGroups().find(n=>n.name.toLowerCase()===a.toLowerCase());s&&this.usersOrGroups.update(n=>[...n,s])}this.currentUserOrGroup.set("")}updateFilteredData(){this.filteredUsersOrGroups()}handleBackspace(){if(!this.currentUserOrGroup()){this.usersOrGroups()}}selected(t){const a=this.allUsersOrGroups().find(s=>s.name===t.option.value.name);a&&(this.usersOrGroups.update(s=>[...s,a]),this.allUsersOrGroups.update(s=>s.filter(n=>n.id!==a.id))),this.currentUserOrGroup.set("")}openFileUploadDialog(){this.isReadOnly||this.enableDownloadSelected||(this.isUpload=!0)}sendBatchDownloadRequest(){this.selectedFilesList=[],this.selectedFilesList=this.selection.selected.map(t=>t.file_url),this.fullPageLoaderService.setLoadingStatus(!0),this.apiService.fileBatchDownload(this.caseId,this.selectedFilesList).pipe((0,j.W)(t=>{throw console.error("Error during file download:",t),this.fullPageLoaderService.setLoadingStatus(!1),this.alertService.errorToaster("top-end","An error occurred. Please try again later."),t})).subscribe({next:t=>{this.fullPageLoaderService.setLoadingStatus(!1),this.alertService.successToster("center","Your download will begin now.",3e3),this.downloadFile(t)},error:t=>{this.fullPageLoaderService.setLoadingStatus(!1),this.alertService.errorToaster("top-end","An error occurred. Please try again later."),console.error("Error in subscription:",t)},complete:()=>{this.fullPageLoaderService.setLoadingStatus(!1),console.log("Batch download request completed.")}})}sendSingleFileDownloadRequest(t,a){this.fullPageLoaderService.setLoadingStatus(!0),this.apiService.singleFileDownload(this.caseId,t).pipe((0,j.W)(s=>{throw console.error("Error during single file download:",s),this.fullPageLoaderService.setLoadingStatus(!1),this.alertService.errorToaster("top-end","An error occurred. Please try again later."),s})).subscribe({next:s=>{this.alertService.successToster("center","Your file download is starting now.",3e3),this.fullPageLoaderService.setLoadingStatus(!1),this.downloadSingleFile(s,a)},error:s=>{this.fullPageLoaderService.setLoadingStatus(!1),this.alertService.errorToaster("top-end","An error occurred. Please try again later."),console.error("Error in subscription:",s)},complete:()=>{this.fullPageLoaderService.setLoadingStatus(!1),console.log("Single file download request completed.")}})}downloadFile(t){const a=new Blob([t],{type:"application/zip"}),s=window.URL.createObjectURL(a),n=document.createElement("a");n.href=s,n.download="batch-files.zip",n.click(),window.URL.revokeObjectURL(s)}downloadSingleFile(t,a){const s=window.URL.createObjectURL(t),n=document.createElement("a");n.href=s,n.download=a,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(s)}deleteConfirmation(){this.alertService.confirmAlert("Are you sure?",`Do you want to remove this Case?  ID: ${this.caseData.case_id}?`,"warning",!0,"No",!0,"Yes, Proceed",!0,this.removeCase.bind(this))}clickCreateCase(){this.isReadOnly||this.form.disabled||this.form.invalid||this.alertService.confirmAlert("Are you sure?",`Do you want to create this user with Case ID: ${this.form.value.case_id}`,"warning",!0,"No",!0,"Yes, Proceed",!1,this.submit.bind(this))}submit(){this.form.invalid?console.error("Form is invalid"):(this.fullPageLoaderService.setLoadingStatus(!0),this.apiService.createNewCase({case_id:this.form.value.case_id,description:this.form.value.description}).subscribe({next:a=>{const s={id:a.data.id};console.log("Case creation successful:",a),this.alertService.successAlert("center","Case creation success","",3e3),this.router.navigate(["/document-managemnt/single-case"],{queryParams:s})},error:a=>{this.fullPageLoaderService.setLoadingStatus(!1),console.error("Registration failed:",a),this.alertService.errorAlert("center","Case creation failed",a.error.errorCode===_.C.ALREADY_EXIST||a.error.errorCode===_.C.ACCESSDENIED?a.error.message:"",3e3,!1,"",!1)},complete:()=>{this.fullPageLoaderService.setLoadingStatus(!1),console.log("Case creation request completed.")}}))}removeCase(){!this.form.invalid||this.isCaseCreation||this.isReadOnly?(this.fullPageLoaderService.setLoadingStatus(!0),this.apiService.removeCase(this.caseId).subscribe({next:t=>{console.log("Case deleation successful:",t),this.alertService.successAlert("center","Case removed successfully","",3e3),this.router.navigate(["/document-managemnt/document-upload"])},error:t=>{this.fullPageLoaderService.setLoadingStatus(!1),console.error("Registration failed:",t),this.alertService.errorAlert("center","Failed to remove the Case",t.error.errorCode===_.C.NOT_FOUND||t.error.errorCode===_.C.ACCESSDENIED?t.error.message:"",3e3,!1,"",!1)},complete:()=>{this.fullPageLoaderService.setLoadingStatus(!1),console.log("Case creation request completed.")}})):console.error("Form is invalid")}enableDesableFrom(t){t?this.form.disable():this.form.enable()}loadCaseData(){if(!this.caseId)return this.isLoading=!0,this.isCaseCreation=!0,void console.error("User Id is invalid");this.isReadOnly=!V.q.hasCommonEditPermission(this.authService),this.isCaseCreation=!1,this.fullPageLoaderService.setLoadingStatus(!0),this.apiService.getOneCase(this.caseId).subscribe({next:t=>{console.log("Case fetching successful:",t),this.caseData=t.data,this.form.patchValue(this.caseData),this.isReadOnly&&this.form.disable(),this.documentTableData=this.caseData.documents,this.loadDocumentTableData(),console.log("this.caseData"),console.log(this.caseData),console.log("this.caseData"),this.isLoading=!1},error:t=>{this.enableDesableFrom(!0),this.fullPageLoaderService.setLoadingStatus(!1),console.error("Case loading failed:",t),t.error.errorCode===_.C.NOT_FOUND?this.alertService.errorAlert("center","Case not found",t.error.message,3e3,!1,"",!1):t.error.errorCode===_.C.ACCESSDENIED?this.alertService.errorAlert("center","You are not permitted to load this case",t.error.message,4e3,!1,"",!1):this.alertService.errorAlert("center","Error while loading case details","",3e3,!1,"",!1),this.router.navigate(["/document-managemnt/document-upload"])},complete:()=>{this.fullPageLoaderService.setLoadingStatus(!1),console.log("Case loading request completed.")}})}loadDocumentTableData(){this.dataSource=new c.I6(this.documentTableData),this.dataSource.paginator=this.paginator}clickBack(){this.router.navigate(["/document-managemnt/document-upload"])}static#e=this.\u0275fac=function(a){return new(a||i)(e.rXU(C.Ix),e.rXU(C.nX),e.rXU(x.I),e.rXU(T),e.rXU(G.u),e.rXU(U.J))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["app-single-case-table-pagination"]],viewQuery:function(a,s){if(1&a&&e.GBs(A.iy,5),2&a){let n;e.mGM(n=e.lsd())&&(s.paginator=n.first)}},inputs:{currentUserOrGroup:[1,"currentUserOrGroup"]},outputs:{currentUserOrGroup:"currentUserOrGroupChange"},standalone:!0,features:[e.Jv_([T,G.u,{provide:F.$T,useValue:{expandedHeight:"48px",collapsedHeight:"48px",animationDuration:"225ms cubic-bezier(0.4,0.0,0.2,1)"}}]),e.aNF],decls:10,vars:6,consts:[[1,"container"],[3,"change","ngModelChange","ngModel"],["class","row",4,"ngIf"],["class","row justify-content-start",4,"ngIf"],[1,"row"],[1,"col"],["class","m-r-8","mat-flat-button","","color","warn",4,"ngIf"],[1,"b-1","shadow-none"],[3,"formGroup"],[1,"mat-subtitle-2","f-s-14","f-w-600","m-b-2","d-block"],["style","color: black; vertical-align: middle; margin-bottom: 3px;","name","lock","class","icon-22",4,"ngIf"],["appearance","outline","color","primary",1,"w-100","m-b-0"],["formControlName","case_id","matInput","","placeholder","","value","CASE_NOV_102",3,"disabled"],[4,"ngIf"],["formControlName","description","matInput","","value","Test Description about case",3,"disabled"],["align","end",4,"ngIf"],["name","lock",1,"icon-22",2,"color","black","vertical-align","middle","margin-bottom","3px"],["align","end"],["type","button","mat-stroked-button","","color","warn",1,"m-r-10",3,"click"],[2,"font-size","1.4rem"],["type","button","mat-flat-button","","color","primary",1,"m-r-8",3,"click","disabled"],[1,"row","justify-content-start"],["mat-button","",3,"click"],[3,"backToCaseDetails","caseId"],["class","col",4,"ngIf"],[1,"document-card","b-1","shadow-none"],[1,"row","justify-content-between"],[1,"col","p-t-4"],[1,"mat-subtitle-1","f-s-18","f-w-600"],["class","col-sm-6 col-md-6 col-lg-6 p-t-6",4,"ngIf"],[1,"col-sm-6","col-md-6","col-lg-6","p-t-6"],["mat-stroked-button","",3,"disabled","click",4,"ngIf"],["class","download-mat-spinner","mat-stroked-button","",3,"disabled",4,"ngIf"],["class","col-left",4,"ngIf"],["class","table-responsive",4,"ngIf"],["showFirstLastButtons","","aria-label","Select page of periodic elements",3,"pageSizeOptions"],["mat-stroked-button","",3,"click","disabled"],["aria-hidden","false",2,"color","#4456e9"],["aria-hidden","false",2,"color","#24db0e"],["mat-stroked-button","",1,"download-mat-spinner",3,"disabled"],["color","accent","diameter","20"],[1,"col-left"],["appearance","outline","color","primary",1,"w-50","m-b-0"],["matInput","","placeholder","Filter",3,"keyup"],[1,"table-responsive"],[1,"justify-content-between"],[1,"col","align-items-start","d-flex","align-items-center","gap-2"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","document_name"],["mat-cell","","class","mat-body-1",4,"matCellDef"],["matColumnDef","action"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],[3,"change","checked","indeterminate","aria-label"],["mat-cell",""],[3,"click","change","checked","aria-label"],["mat-cell","",1,"mat-body-1"],[1,"d-flex","align-items-center"],["name","file-type-pdf",1,"icon-20",2,"color","rgb(190, 8, 8)","font-weight","bold"],[1,"d-flex","flex-column"],[2,"font-size","12px","color","gray","line-height","1"],["class","cursor-pointer",3,"click",4,"ngIf"],[1,"cursor-pointer",3,"click"],["name","download",1,"icon-22",2,"color","rgb(16, 152, 6)","font-weight","bold"],[1,"d-flex","justify-content-center","gap-4"],["class","cursor-pointer",4,"ngIf"],[1,"cursor-pointer"],["name","edit",1,"icon-22"],["name","trash",1,"icon-22",2,"color","red"],["mat-row",""],["mat-flat-button","","color","warn",1,"m-r-8"],[3,"expanded"],[2,"justify-content","center"],["class","m-r-8","mat-flat-button","","color","warn",3,"disabled","click",4,"ngIf"],["mat-flat-button","","color","warn",1,"m-r-8",3,"click","disabled"]],template:function(a,s){1&a&&(e.j41(0,"div",0)(1,"p")(2,"mat-slide-toggle",1),e.bIt("change",function(){return s.onToggleChange()}),e.mxI("ngModelChange",function(d){return e.DH7(s.isAdmin,d)||(s.isAdmin=d),d}),e.EFF(3),e.k0s()(),e.DNE(4,ft,23,10,"div",2)(5,ht,5,1,"div",3)(6,Et,2,1,"div",2),e.j41(7,"div",4)(8,"div",5),e.DNE(9,xt,9,2,"mat-accordion",6),e.k0s()()()),2&a&&(e.R7$(2),e.R50("ngModel",s.isAdmin),e.R7$(),e.JRh(s.isAdmin?"Admin View":"User View"),e.R7$(),e.Y8G("ngIf",!s.isUpload),e.R7$(),e.Y8G("ngIf",s.isUpload&&s.isAdmin),e.R7$(),e.Y8G("ngIf",!s.isUpload),e.R7$(3),e.Y8G("ngIf",!s.isCaseCreation))},dependencies:[c.tP,c.Zl,c.tL,c.cC,c.YV,c.iL,c.KS,c.$R,c.NB,h.MD,h.bT,m.YN,m.qT,m.me,m.BC,m.cb,m.vS,I.RG,I.rl,I.nJ,I.TL,m.X1,m.j4,m.JD,g.Hu,g.RN,g.YY,g.m2,g.MM,Y.G,k.So,N.fg,y.sG,F.BS,F.GK,F.Z2,F.WN,F.Q6,w.$z,R.An,W.LG,A.iy,R.m_,B.Cn,w.Hl,y.mV,D.X4,D.Jc,X.Ph,C.iI,O.Wk,k.g7,ee.YN,L.jL,ot,W.D6,z.y,F.MY],styles:[".mat-column-select[_ngcontent-%COMP%]{padding-right:0!important}.document-card[_ngcontent-%COMP%]   .mat-mdc-card-header[_ngcontent-%COMP%]{display:inline-block}.download-mat-spinner[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{width:18px!important;height:18px!important}mat-accordion[_ngcontent-%COMP%]{display:flex;justify-content:end}mat-panel-title[_ngcontent-%COMP%]{color:#f14d7c!important}mat-panel-description[_ngcontent-%COMP%]{justify-content:center}mat-expansion-panel-header[_ngcontent-%COMP%]   .mat-expansion-indicator[_ngcontent-%COMP%]{visibility:hidden!important}"]})}return i})(),Ut=(()=>{class i{static#e=this.\u0275fac=function(a){return new(a||i)};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["app-single-case-details"]],standalone:!0,features:[e.aNF],decls:1,vars:0,template:function(a,s){1&a&&e.nrm(0,"app-single-case-table-pagination")},dependencies:[Gt]})}return i})();var ae=r(2014);const Nt=[{path:"",children:[{path:"document-upload",component:Fe,canActivate:[ae.K],data:{title:"Available Cases",expectedRole:l.N.ADMIN}},{path:"document-access",component:Xe,canActivate:[ae.K],data:{title:"Manage Document Access",expectedRole:l.N.ADMIN}},{path:"single-case",component:Ut,data:{title:"Case Detail"}}]}]}}]);